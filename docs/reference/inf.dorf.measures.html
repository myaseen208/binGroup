<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Operating characteristics for informative two-stage hierarchical (Dorfman) testing — inf.dorf.measures • binGroup</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Operating characteristics for informative two-stage hierarchical (Dorfman) testing — inf.dorf.measures"><meta property="og:description" content="Calculate the expected number of tests and accuracy 
measures for each individual using informative two-stage 
hierarchical (Dorfman) testing, given a vector of individual 
probabilities and a testing configuration."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">binGroup</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Operating characteristics for informative two-stage hierarchical (Dorfman) testing</h1>
    
    <div class="hidden name"><code>inf.dorf.measures.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate the expected number of tests and accuracy 
measures for each individual using informative two-stage 
hierarchical (Dorfman) testing, given a vector of individual 
probabilities and a testing configuration.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">inf.dorf.measures</span><span class="op">(</span><span class="va">prob</span>, <span class="va">se</span>, <span class="va">sp</span>, <span class="va">N</span>, <span class="va">pool.sizes</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>prob</dt>
<dd><p>vector of probabilities corresponding to each individual's 
risk of disease.</p></dd>


<dt>se</dt>
<dd><p>the sensitivity of the diagnostic test.</p></dd>


<dt>sp</dt>
<dd><p>the specificity of the diagnostic test.</p></dd>


<dt>N</dt>
<dd><p>block size/initial group size that is not tested. This
is the total number of individuals being tested. The 
details of <kbd>block.sz</kbd> are given under 'Details'.</p></dd>


<dt>pool.sizes</dt>
<dd><p>a vector of pool sizes for the first stage 
of testing.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list containing:</p>
<dl><dt>e</dt>
<dd><p>the expected number of tests needed to decode all N
individuals.</p></dd>

<dt>v</dt>
<dd><p>the variance of the total number of tests needed to 
decode all N individuals.</p></dd>

<dt>summary</dt>
<dd><p>a matrix containing the pool, probability of 
disease, pooling sensitivity, pooling specificity, pooling 
positive predictive value, and pooling negative predictive 
value for each individual. The pool column identifies which 
pool each individual is contained in for the first stage of
testing.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function utilizes the equations given by McMahan et al. 
(2012) for informative two-stage hierarchical (Dorfman) testing. 
It also repurposes functions written by Christopher S. McMahan (see
<a href="http://chrisbilder.com/grouptesting" class="external-link">http://chrisbilder.com/grouptesting</a>)
for the implementation of informative Dorfman testing and directly 
uses functions written for the calculation of the associated operating 
characteristics. This function calculates the operating characteristics 
for informative two-stage hierarchical (Dorfman) testing. Operating 
characteristics calculated are expected number of tests, and pooling 
sensitivity, pooling specificity, pooling positive predictive value, 
and pooling negative predictive value for each individual.</p>
<p>The specified <kbd>N</kbd> represents the block size used in the pool-specific
optimal Dorfman (PSOD) method. This is the total number of individuals being
tested by the algorithm. This block is not initially tested. Instead, 
multiple initial pool sizes within this block are found and tested in 
the first stage of testing. The second stage of testing consists of individual
retesting. For more information on block size specification, see McMahan et
al. (2012).</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>This function returns the pooling positive and negative
predictive values for all individuals even though these measures are 
diagnostic specific; i.e., PPPV (PNPV) should only be considered
for those individuals who have tested positive (negative).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>McMahan, C., Tebbs, J., Bilder, C. (2012).
“Informative Dorfman Screening.”
<em>Biometrics</em>, <b>68</b>(1), 287--296.
ISSN 0006341X, <a href="https://doi.org/10.1111/j.1541-0420.2011.01644.x" class="external-link">doi:10.1111/j.1541-0420.2011.01644.x</a>
, <a href="http://www.ncbi.nlm.nih.gov/pubmed/21762119" class="external-link">http://www.ncbi.nlm.nih.gov/pubmed/21762119</a>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="Array.Measures.html">Array.Measures</a></code> for calculating operating characteristics
under array testing without master pooling, 
<code><a href="MasterPool.Array.Measures.html">MasterPool.Array.Measures</a></code> for non-informative array 
testing with master pooling, and <code>inf.dorf.measures</code> 
for informative two-stage hierarchical testing. See 
<code><a href="p.vec.func.html">p.vec.func</a></code> for generating a vector of 
individual risk probabilities for informative group testing.</p>
<p>This function repurposed code from <code><a href="opt.info.dorf.html">opt.info.dorf</a></code> so that
PSOD testing could be implemented using all possible testing configurations
instead of a greedy algorithm. This function also used
<code><a href="characteristics.pool.html">characteristics.pool</a></code> and <code><a href="accuracy.dorf.html">accuracy.dorf</a></code>
to calculate operating characteristics for the optimal set of 
pool sizes.</p>
<p><a href="http://chrisbilder.com/grouptesting" class="external-link">http://chrisbilder.com/grouptesting</a></p>
<p>Other Operating characteristic functions: <code><a href="Array.Measures.html">Array.Measures</a></code>,
  <code><a href="MasterPool.Array.Measures.html">MasterPool.Array.Measures</a></code>,
  <code><a href="hierarchical.desc2.html">hierarchical.desc2</a></code></p>
<p>Other Informative Dorfman functions: <code><a href="accuracy.dorf.html">accuracy.dorf</a></code>,
  <code><a href="characteristics.pool.html">characteristics.pool</a></code>,
  <code><a href="opt.info.dorf.html">opt.info.dorf</a></code>, <code><a href="opt.pool.size.html">opt.pool.size</a></code>,
  <code><a href="pool.specific.dorf.html">pool.specific.dorf</a></code>,
  <code><a href="thresh.val.dorf.html">thresh.val.dorf</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>The majority of this function was originally written by 
Christopher S. McMahan for McMahan et al. (2012). The function was 
obtained from <a href="http://chrisbilder.com/grouptesting" class="external-link">http://chrisbilder.com/grouptesting</a>. Minor modifications 
were made to the function for inclusion in the binGroup package.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Calculate the operating characteristics for </span></span></span>
<span class="r-in"><span><span class="co">#   informative two-stage hierarchical (Dorfman) testing</span></span></span>
<span class="r-in"><span><span class="co">#   with an overall disease prevalence of E(p(i)) = 0.01,</span></span></span>
<span class="r-in"><span><span class="co">#   where a block size of 50 is split into initial pools</span></span></span>
<span class="r-in"><span><span class="co">#   of 18, 13, 11, and 8 individuals.</span></span></span>
<span class="r-in"><span><span class="co"># This example takes less than 1 second to run.</span></span></span>
<span class="r-in"><span><span class="co"># Estimated running time was calculated using a </span></span></span>
<span class="r-in"><span><span class="co">#   computer with 16 GB of RAM and one core of an </span></span></span>
<span class="r-in"><span><span class="co">#   Intel i7-6500U processor.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">8791</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">inf.dorf.measures</span><span class="op">(</span>prob<span class="op">=</span><span class="fu"><a href="beta.dist.html">beta.dist</a></span><span class="op">(</span>p<span class="op">=</span><span class="fl">0.01</span>, alpha<span class="op">=</span><span class="fl">2</span>, </span></span>
<span class="r-in"><span>grp.sz<span class="op">=</span><span class="fl">50</span>, simul<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, se<span class="op">=</span><span class="fl">0.95</span>, sp<span class="op">=</span><span class="fl">0.95</span>, N<span class="op">=</span><span class="fl">50</span>, </span></span>
<span class="r-in"><span>pool.sizes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">18</span>, <span class="fl">13</span>, <span class="fl">11</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Using simulation"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $e</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 11.32286</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $v</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 79.92548</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    pool probability    PSe       PSp       PPV       NPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1 0.000964839 0.9025 0.9945235 0.1373025 0.9999053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1 0.001491870 0.9025 0.9945457 0.1982183 0.9998535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     1 0.001906296 0.9025 0.9945632 0.2407240 0.9998128</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     1 0.002272982 0.9025 0.9945786 0.2749664 0.9997767</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     1 0.002609000 0.9025 0.9945928 0.3039116 0.9997436</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     1 0.002925607 0.9025 0.9946062 0.3292869 0.9997124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     1 0.003228595 0.9025 0.9946190 0.3520164 0.9996826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     1 0.003519830 0.9025 0.9946313 0.3725625 0.9996539</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     1 0.003803796 0.9025 0.9946433 0.3914722 0.9996258</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    1 0.004083119 0.9025 0.9946551 0.4090783 0.9995983</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    1 0.004360304 0.9025 0.9946668 0.4256504 0.9995709</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    1 0.004628075 0.9025 0.9946782 0.4408724 0.9995444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    1 0.004899461 0.9025 0.9946897 0.4555671 0.9995176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    1 0.005165369 0.9025 0.9947010 0.4692993 0.9994913</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    1 0.005434036 0.9025 0.9947124 0.4825501 0.9994647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16    1 0.005708476 0.9025 0.9947240 0.4954811 0.9994376</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17    1 0.005982808 0.9025 0.9947357 0.5078366 0.9994104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18    1 0.006258616 0.9025 0.9947474 0.5197209 0.9993831</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19    2 0.006535886 0.9025 0.9931101 0.4628735 0.9993545</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20    2 0.006818977 0.9025 0.9931217 0.4739207 0.9993264</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21    2 0.007105802 0.9025 0.9931334 0.4847014 0.9992979</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22    2 0.007401755 0.9025 0.9931455 0.4954141 0.9992685</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23    2 0.007698052 0.9025 0.9931576 0.5057440 0.9992390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24    2 0.007997275 0.9025 0.9931699 0.5157962 0.9992092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25    2 0.008306605 0.9025 0.9931826 0.5258088 0.9991784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26    2 0.008631119 0.9025 0.9931959 0.5359212 0.9991461</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27    2 0.008953608 0.9025 0.9932092 0.5455952 0.9991139</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28    2 0.009290883 0.9025 0.9932230 0.5553347 0.9990803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29    2 0.009635682 0.9025 0.9932372 0.5649143 0.9990458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30    2 0.009994855 0.9025 0.9932520 0.5745107 0.9990100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31    2 0.010366220 0.9025 0.9932673 0.5840459 0.9989728</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32    3 0.010750141 0.9025 0.9918248 0.5453828 0.9989329</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33    3 0.011147978 0.9025 0.9918406 0.5549548 0.9988930</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34    3 0.011575954 0.9025 0.9918576 0.5648589 0.9988501</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35    3 0.012009098 0.9025 0.9918749 0.5744913 0.9988066</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36    3 0.012478998 0.9025 0.9918936 0.5845224 0.9987594</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37    3 0.012972341 0.9025 0.9919133 0.5946135 0.9987098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38    3 0.013503307 0.9025 0.9919345 0.6050019 0.9986564</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39    3 0.014073845 0.9025 0.9919573 0.6156549 0.9985989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40    3 0.014690843 0.9025 0.9919821 0.6266227 0.9985367</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41    3 0.015354022 0.9025 0.9920086 0.6378174 0.9984697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42    3 0.016084387 0.9025 0.9920380 0.6494890 0.9983959</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43    4 0.016900403 0.9025 0.9907414 0.6262681 0.9983111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44    4 0.017805662 0.9025 0.9907766 0.6394907 0.9982192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45    4 0.018852616 0.9025 0.9908175 0.6538021 0.9981128</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46    4 0.020097982 0.9025 0.9908662 0.6695940 0.9979859</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47    4 0.021610914 0.9025 0.9909255 0.6871847 0.9978314</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48    4 0.023636716 0.9025 0.9910052 0.7083720 0.9976239</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49    4 0.026567983 0.9025 0.9911212 0.7350461 0.9973223</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50    4 0.032217050 0.9025 0.9913466 0.7763818 0.9967366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Boan Zhang, Christopher Bilder, Brad Biggerstaff, Frank Schaarschmidt, Brianna Hitt.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

