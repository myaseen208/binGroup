<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Sample Size Iteration for One Parameter Binomial Problem — binDesign • binGroup</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Sample Size Iteration for One Parameter Binomial Problem — binDesign"><meta property="og:description" content="This function increases the sample size until a maximal sample size or a prespecified power is achieved."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">binGroup</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sample Size Iteration for One Parameter Binomial Problem</h1>
    
    <div class="hidden name"><code>binDesign.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function increases the sample size until a maximal sample size or a prespecified power is achieved.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">binDesign</span><span class="op">(</span><span class="va">nmax</span>, <span class="va">delta</span>, <span class="va">p.hyp</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span> power <span class="op">=</span> <span class="fl">0.8</span>, method <span class="op">=</span> <span class="st">"CP"</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>nmax</dt>
<dd><p>integer, maximal number of trials (individuals under observation) allowed in the iteration</p></dd>

  <dt>delta</dt>
<dd><p>absolute difference between the threshold and the true proportion which shall be detectable with the specified power</p></dd>

  <dt>p.hyp</dt>
<dd><p>threshold proportion to test against in the hypothesis, specify as a value between 0 and 1</p></dd>

  <dt>conf.level</dt>
<dd><p>Confidence level of the decision, default is 0.95</p></dd>

  <dt>power</dt>
<dd><p>Level of power to be achieved to be specified as a probability between 0 and 1</p></dd>

  <dt>method</dt>
<dd><p>character string specifying the CImethod to be used for evaluation, see argument method in bgtCI</p></dd>


  <dt>alternative</dt>
<dd><p>character string, defining the alternative hypothesis, either <kbd>'two.sided'</kbd>, <kbd>'less'</kbd> or <kbd>'greater'</kbd>
	where <kbd>'less'</kbd> calculates the probability that p.hyp is excluded by an upper confidence limit given that the true proportion is p.hyp-delta,
	<kbd>'greater'</kbd> calculates the probability that p.hyp is excluded by a lower confidence limit given that the true proportion is p.hyp+delta.
	<kbd>'two.sided'</kbd> calculates min(power(p.hyp-delta, p.hyp+delta)) for a two-sided CI, thus can result in much lower power.</p></dd>

  </dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The power of a confidence interval here is defined as the probability that a confidence interval or limit excludes the threshold parameter (<kbd>p.hyp</kbd>) of the hypothesis.</p>
<p>This function increases the number of trials (number of individuals under observation) until a pre-specified power is reached.
Since the power does not increase monotone with increasing n for binomial proportions but oscillates between local maxima and minima, 
the simple iteration given here will generally result in selecting those n, for which the given CI method shows a local minimum of 
coverage if the null hypothesis is true. The power can be identical for different methods, depending on the particular combination of n, p.hyp, conf.level.</p>
<p>Especially for large n, the calculation time may become large (particularly for Blaker). Then only the range of sample size which is of interest
can be specified in nmax, f.e. as: nmax=c(150,300). Alternatively, the function binPower might be used instead
to calculate power and bias only for some particular combinations of n, delta, p.hyp,... .</p>
<p>Note that coverage probability and power are not necessarily symmetric for upper and lower bound of binomial CI.</p>
<p>The results can be visualized by application of the function plot() to the returned object of this function.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>a list</p>
<dl><dt>powerout</dt>
<dd><p>power value, either the power of the first n exceeding the pre-specified power,
 or the maximal power achieved in the specified range of n if the specified power has not been reached</p></dd>

  <dt>nout</dt>
<dd><p>corresponding sample size n (the number of trials) for which the prespecified power is reached,
 or the sample size n for which the maximal power has been reached within the specified range,
 if pre-specified power has not been reached.</p></dd>


</dl><p>and additional input and iteration values needed only for the function plot.binDesign.</p>
    </div>
    <div id="references">
    <h2>References</h2>
     

<p><em>Schaarschmidt, F. (2007).</em> Experimental design for one-sided confidence intervals or hypothesis tests in binomial group testing. <em>Communications in Biometry and Crop Science 2 (1), 32-40.</em>
 http://agrobiol.sggw.waw.pl/cbcs/</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Frank Schaarschmidt</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="binPower.html">binPower</a></code> for calculation of power, <code><a href="plot.binDesign.html">plot.binDesign</a></code> for plot of the results</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Find a sample size for which the power to</span></span></span>
<span class="r-in"><span><span class="co"># reject H0: p &gt;= 0.1 in favor of HA: p &lt; 0.1 is</span></span></span>
<span class="r-in"><span><span class="co"># at least 0.9 (90 percent) in case that the</span></span></span>
<span class="r-in"><span><span class="co"># true proportion is 0.04 (i.e. an absolute delta </span></span></span>
<span class="r-in"><span><span class="co"># of 0.06 to the threshold proportion p.hyp=0.1)</span></span></span>
<span class="r-in"><span><span class="co"># The exact one sided Clopper-Pearson CI shall be</span></span></span>
<span class="r-in"><span><span class="co"># used with default confidence level = 0.95.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sasi</span><span class="op">&lt;-</span><span class="fu">binDesign</span><span class="op">(</span> nmax<span class="op">=</span><span class="fl">200</span>, delta<span class="op">=</span><span class="fl">0.06</span>,</span></span>
<span class="r-in"><span> p.hyp<span class="op">=</span><span class="fl">0.1</span>, alternative<span class="op">=</span><span class="st">"less"</span>, method<span class="op">=</span><span class="st">"CP"</span>, power<span class="op">=</span><span class="fl">0.9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sasi</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Power was reached for n = 154 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> with power = 0.9089 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true proportion is less than 0.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assumed true proportion = 0.04 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### One can also plot the result:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sasi</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="binDesign-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For larger sample sizes iteration can be very time consuming.</span></span></span>
<span class="r-in"><span><span class="co"># Better to use only a smaller range of n then:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sasi</span><span class="op">&lt;-</span><span class="fu">binDesign</span><span class="op">(</span> nmax<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">300</span><span class="op">)</span>, delta<span class="op">=</span><span class="fl">0.03</span>, p.hyp<span class="op">=</span><span class="fl">0.1</span>,</span></span>
<span class="r-in"><span> alternative<span class="op">=</span><span class="st">"less"</span>, method<span class="op">=</span><span class="st">"CP"</span>, power<span class="op">=</span><span class="fl">0.9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sasi</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Power of 0.9 was not reached in the range of n = 200 , 300 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximal power was reached for n = 298 with power = 0.5703 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true proportion is less than 0.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assumed true proportion = 0.07 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Boan Zhang, Christopher Bilder, Brad Biggerstaff, Frank Schaarschmidt, Brianna Hitt.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

