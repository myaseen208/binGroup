<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Find the optimal testing configuration — OTC • binGroup</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Find the optimal testing configuration — OTC"><meta property="og:description" content="Find the optimal testing configuration (OTC) for standard group testing
algorithms and calculate the associated operating characteristics."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">binGroup</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find the optimal testing configuration</h1>
    
    <div class="hidden name"><code>OTC.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Find the optimal testing configuration (OTC) for standard group testing
algorithms and calculate the associated operating characteristics.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">OTC</span><span class="op">(</span><span class="va">algorithm</span>, p <span class="op">=</span> <span class="cn">NULL</span>, probabilities <span class="op">=</span> <span class="cn">NULL</span>, Se <span class="op">=</span> <span class="fl">0.99</span>, Sp <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  <span class="va">group.sz</span>, obj.fn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ET"</span>, <span class="st">"MAR"</span><span class="op">)</span>, weights <span class="op">=</span> <span class="cn">NULL</span>, alpha <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>algorithm</dt>
<dd><p>character string defining the group testing algorithm to be used.
Non-informative testing options include two-stage hierarchical ("<kbd>D2</kbd>"),
three-stage hierarchical ("<kbd>D3</kbd>"), square array testing without master 
pooling ("<kbd>A2</kbd>"), and square array testing without master pooling ("<kbd>A2M</kbd>"). 
Informative testing options include two-stage hierarchical ("<kbd>ID2</kbd>"),
three-stage hierarchical ("<kbd>ID3</kbd>"), and square array testing without 
master pooling ("<kbd>IA2</kbd>").</p></dd>


<dt>p</dt>
<dd><p>overall probability of disease that will be used to generate a
vector/matrix of individual probabilities. For non-informative algorithms, a 
homogeneous set of probabilities will be used. For informative algorithms, the 
<code><a href="p.vec.func.html">p.vec.func</a></code> function will be used to generate a heterogeneous 
set of probabilities. Either <kbd>p</kbd> or <kbd>probabilities</kbd> should be specified, 
but not both.</p></dd>


<dt>probabilities</dt>
<dd><p>a vector of individual probabilities, which is homogeneous 
for non-informative testing algorithms and heterogeneous for informative 
testing algorithms. Either  <kbd>p</kbd> or <kbd>probabilities</kbd> should be specified, 
but not both.</p></dd>


<dt>Se</dt>
<dd><p>the sensitivity of the diagnostic test.</p></dd>


<dt>Sp</dt>
<dd><p>the specificity of the diagnostic test.</p></dd>


<dt>group.sz</dt>
<dd><p>a single group size or range of group sizes for which to 
calculate operating characteristics and/or find the OTC. The details of group 
size specification are given under 'Details'.</p></dd>


<dt>obj.fn</dt>
<dd><p>a list of objective functions which are minimized to find the
OTC. The expected number of tests per individual, "<kbd>ET</kbd>", will always 
be calculated. Additional options include "<kbd>MAR</kbd>" 
(the expected number of tests divided by the expected number of correct 
classifications, described in Malinovsky et al. (2016)), and "<kbd>GR</kbd>" 
(a linear combination of the expected number of tests, the number of 
misclassified negatives, and the number of misclassified positives, 
described in Graff &amp; Roeloffs (1972)). See Hitt et al. (2018) at
<a href="http://chrisbilder.com/grouptesting" class="external-link">http://chrisbilder.com/grouptesting</a> for additional details.</p></dd>


<dt>weights</dt>
<dd><p>a matrix of up to six sets of weights for the GR function. 
Each set of weights is specified by a row of the matrix.</p></dd>


<dt>alpha</dt>
<dd><p>a shape parameter for the beta distribution that specifies the degree of
heterogeneity for the generated probability vector (for informative testing only).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list containing:</p>
<dl><dt>prob</dt>
<dd><p>the probability of disease, as specified by the user.</p></dd>

<dt>alpha</dt>
<dd><p>level of heterogeneity for the generated probability vector
(for informative testing only).</p></dd>

<dt>Se</dt>
<dd><p>the sensitivity of the diagnostic test.</p></dd>

<dt>Sp</dt>
<dd><p>the specificity of the diagnostic test.</p></dd>

<dt>opt.ET, opt.MAR, opt.GR</dt>
<dd><p>a list for each objective function specified
by the user, containing:</p><dl><dt>OTC</dt>
<dd><p>a list specifying elements of the optimal testing configuration, 
which may include:</p><dl><dt>Stage1</dt>
<dd><p>pool size for the first stage of hierarchical testing, if applicable.</p></dd>

<dt>Stage2</dt>
<dd><p>pool sizes for the second stage of hierarchical testing, if applicable.</p></dd>

<dt>Block.sz</dt>
<dd><p>the block size/initial group size for informative Dorfman testing,
which is not tested.</p></dd>

<dt>pool.szs</dt>
<dd><p>pool sizes for the first stage of testing for informative Dorfman
testing.</p></dd>

<dt>Array.dim</dt>
<dd><p>the row/column size for array testing.</p></dd>

<dt>Array.sz</dt>
<dd><p>the overall array size for array testing (the square of the row/column size).</p></dd>

</dl></dd>

<dt>p.vec</dt>
<dd><p>the sorted vector of individual probabilities, if applicable.</p></dd>

<dt>p.mat</dt>
<dd><p>the sorted matrix of individual probabilities in gradient arrangement,
if applicable.</p></dd>

<dt>ET</dt>
<dd><p>the expected testing expenditure for the OTC.</p></dd>

<dt>value</dt>
<dd><p>the value of the objective function per individual.</p></dd>

<dt>PSe</dt>
<dd><p>the overall pooling sensitivity for the algorithm. Further details 
are given under 'Details'.</p></dd>

<dt>PSp</dt>
<dd><p>the overall pooling specificity for the algorithm. Further details 
are given under 'Details'.</p></dd>

<dt>PPPV</dt>
<dd><p>the overall pooling positive predictive value for the algorithm. 
Further details are given under 'Details'.</p></dd>

<dt>PNPV</dt>
<dd><p>the overall pooling negative predictive value for the algorithm. 
Further details are given under 'Details'.</p></dd>

</dl></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function finds the OTC and computes the
associated operating characteristics for standard group testing algorithms,
as described in Hitt et al. (2018) at 
<a href="http://chrisbilder.com/grouptesting" class="external-link">http://chrisbilder.com/grouptesting</a>.</p>
<p>Available algorithms include two- and three-stage hierarchical testing and
array testing with and without master pooling. Both non-informative and informative
group testing settings are allowed for each algorithm, except informative 
array testing with master pooling is unavailable because this method has not 
appeared in the group testing literature. Operating characteristics calculated are
expected number of tests, pooling sensitivity, pooling specificity, pooling
positive predictive value, and pooling negative predictive value for each individual.</p>
<p>The value(s) specified by <kbd>group.sz</kbd> represent the initial (stage 1) 
group size for three-stage hierarchical testing and non-informative 
two-stage hierarchical testing. For informative two-stage hierarchical testing, 
the <kbd>group.sz</kbd> specified represents the block size used in the pool-specific
optimal Dorfman (PSOD) method, where the initial group (block) is not
tested. For more details on informative two-stage hierarchical testing 
implemented via the PSOD method, see Hitt et al. (2018) and McMahan et al. (2012a).
For array testing without master pooling, the <kbd>group.sz</kbd> specified
represents the row/column size for initial (stage 1) testing. For array testing 
with master pooling, the <kbd>group.sz</kbd> specified represents the row/column size 
for stage 2 testing. The group size for initial testing is overall array size, 
given by the square of the row/column size.</p>
<p>If a single value is provided for <kbd>group.sz</kbd> with array testing or
non-informative two-stage hierarchical testing, operating
characteristics will be calculated and no optimization will be performed.
If a single value is provided for <kbd>group.sz</kbd> with three-stage hierarchical or 
informative two-stage hierarchical, the OTC will be  
found over all possible configurations. If a range of group sizes is specified, 
the OTC will be found over all group sizes.</p>
<p>The displayed pooling sensitivity, pooling specificity, pooling positive 
predictive value, and pooling negative predictive value are weighted 
averages of the corresponding individual accuracy measures for all 
individuals within the initial group for a hierarchical algorithm, or 
within the entire array for an array-based algorithm.
Expressions for these averages are provided in the Supplementary 
Material for Hitt et al. (2018). These expressions are based on accuracy 
definitions given by Altman and Bland (1994a, 1994b).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Altman, D., Bland, J. (1994).
“Diagnostic tests 1: sensitivity and specificity.”
<em>BMJ</em>, <b>308</b>, 1552.</p>
<p>Altman, D., Bland, J. (1994).
“Diagnostic tests 2: predictive values.”
<em>BMJ</em>, <b>309</b>, 102.</p>
<p>Graff, L., Roeloffs, R. (1972).
“Group testing in the presence of test error; an extension of the Dorfman procedure.”
<em>Technometrics</em>, <b>14</b>(1), 113--122.
ISSN 15372723, <a href="https://doi.org/10.1080/00401706.1972.10488888" class="external-link">doi:10.1080/00401706.1972.10488888</a>
, <a href="https://www.tandfonline.com/doi/abs/10.1080/00401706.1972.10488888" class="external-link">https://www.tandfonline.com/doi/abs/10.1080/00401706.1972.10488888</a>.</p>
<p>Hitt, B., Bilder, C., Tebbs, J., McMahan, C. (2018).
“The Optimal Group Size Controversy for Infectious Disease Testing: Much Ado About Nothing?!”
Manuscript submitted for publication.</p>
<p>Malinovsky, Y., Albert, P., Roy, A. (2016).
“Reader reaction: A note on the evaluation of group testing algorithms in the presence of misclassification.”
<em>Biometrics</em>, <b>72</b>(1), 299--302.
ISSN 15410420, <a href="https://doi.org/10.1111/biom.12385" class="external-link">doi:10.1111/biom.12385</a>
.</p>
<p>McMahan, C., Tebbs, J., Bilder, C. (2012).
“Informative Dorfman Screening.”
<em>Biometrics</em>, <b>68</b>(1), 287--296.
ISSN 0006341X, <a href="https://doi.org/10.1111/j.1541-0420.2011.01644.x" class="external-link">doi:10.1111/j.1541-0420.2011.01644.x</a>
, <a href="http://www.ncbi.nlm.nih.gov/pubmed/21762119" class="external-link">http://www.ncbi.nlm.nih.gov/pubmed/21762119</a>.</p>
<p>McMahan, C., Tebbs, J., Bilder, C. (2012).
“Two-Dimensional Informative Array Testing.”
<em>Biometrics</em>, <b>68</b>(3), 793--804.
ISSN 0006341X, <a href="https://doi.org/10.1111/j.1541-0420.2011.01726.x" class="external-link">doi:10.1111/j.1541-0420.2011.01726.x</a>
, <a href="http://www.ncbi.nlm.nih.gov/pubmed/22212007" class="external-link">http://www.ncbi.nlm.nih.gov/pubmed/22212007</a>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="NI.Dorf.html">NI.Dorf</a></code> for non-informative two-stage (Dorfman) testing, <code><a href="Inf.Dorf.html">Inf.Dorf</a></code> for
informative two-stage (Dorfman) testing, <code><a href="NI.D3.html">NI.D3</a></code> for non-informative three-stage
hierarchical testing, <code><a href="Inf.D3.html">Inf.D3</a></code> for informative three-stage hierarchical testing,
<code><a href="NI.Array.html">NI.Array</a></code> for non-informative array testing, <code><a href="Inf.Array.html">Inf.Array</a></code> for informative
array testing, and <code><a href="NI.A2M.html">NI.A2M</a></code> for non-informative array testing with master pooling.</p>
<p><a href="http://chrisbilder.com/grouptesting" class="external-link">http://chrisbilder.com/grouptesting</a></p>
<p>Other OTC functions: <code><a href="Inf.Array.html">Inf.Array</a></code>,
  <code><a href="Inf.D3.html">Inf.D3</a></code>, <code><a href="Inf.Dorf.html">Inf.Dorf</a></code>,
  <code><a href="NI.A2M.html">NI.A2M</a></code>, <code><a href="NI.Array.html">NI.Array</a></code>,
  <code><a href="NI.D3.html">NI.D3</a></code>, <code><a href="NI.Dorf.html">NI.Dorf</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Brianna D. Hitt</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Find the OTC for non-informative</span></span></span>
<span class="r-in"><span><span class="co">#   two-stage hierarchical (Dorfman) testing</span></span></span>
<span class="r-in"><span><span class="co"># This example takes less than 1 second to run.</span></span></span>
<span class="r-in"><span><span class="co"># Estimated running time was calculated using a </span></span></span>
<span class="r-in"><span><span class="co">#   computer with 16 GB of RAM and one core of an </span></span></span>
<span class="r-in"><span><span class="co">#   Intel i7-6500U processor.</span></span></span>
<span class="r-in"><span><span class="fu">OTC</span><span class="op">(</span>algorithm<span class="op">=</span><span class="st">"D2"</span>, p<span class="op">=</span><span class="fl">0.05</span>, Se<span class="op">=</span><span class="fl">0.99</span>, Sp<span class="op">=</span><span class="fl">0.99</span>, group.sz<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">100</span>,</span></span>
<span class="r-in"><span>obj.fn<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ET"</span>, <span class="st">"MAR"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> You have specified an overall probability of disease. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  A probability vector will be generated based on the algorithm specified.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Non-informative Testing - alpha will be ignored. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Algorithm: Non-informative two-stage hierarchical (Dorfman) testing </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 11 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 13 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 17 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 18 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 19 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 21 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 22 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 25 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 26 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 27 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 28 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 29 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 30 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 31 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 32 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 33 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 34 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 35 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 36 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 37 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 38 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 39 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 40 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 41 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 42 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 43 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 44 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 45 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 46 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 47 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 48 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 50 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 51 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 52 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 53 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 54 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 55 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 56 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 57 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 58 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 59 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 60 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 61 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 62 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 63 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 64 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 65 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 66 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 67 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 68 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 69 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 70 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 71 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 72 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 73 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 74 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 75 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 76 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 77 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 78 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 79 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 80 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 81 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 82 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 83 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 84 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 85 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 86 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 87 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 88 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 89 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 90 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 91 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 92 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 93 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 94 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 95 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 96 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 97 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 98 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 99 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of minutes running: 0.0019 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Sp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$OTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$OTC$Stage1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$p.vec</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.05 0.05 0.05 0.05 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$ET</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.158473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4316947</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$PSe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$PSp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9980822</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$PPPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9641539</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$PNPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9989517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$OTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$OTC$Stage1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$p.vec</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.05 0.05 0.05 0.05 0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$ET</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.158473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4329142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$PSe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$PSp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9980822</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$PPPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9641539</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$PNPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9989517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Find the OTC for informative</span></span></span>
<span class="r-in"><span><span class="co">#   two-stage hierarchical (Dorfman) testing, implemented</span></span></span>
<span class="r-in"><span><span class="co">#   via the pool-specific optimal Dorfman (PSOD) method</span></span></span>
<span class="r-in"><span><span class="co">#   described in McMahan et al. (2012a), where the greedy</span></span></span>
<span class="r-in"><span><span class="co">#   algorithm proposed for PSOD is replaced by considering</span></span></span>
<span class="r-in"><span><span class="co">#   all possible testing configurations.</span></span></span>
<span class="r-in"><span><span class="co"># A vector of individual probabilities is generated using</span></span></span>
<span class="r-in"><span><span class="co">#   the expected value of order statistics from a beta </span></span></span>
<span class="r-in"><span><span class="co">#   distribution with p = 0.01 and a heterogeneity level </span></span></span>
<span class="r-in"><span><span class="co">#   of alpha = 0.5. Depending on the specified probability, </span></span></span>
<span class="r-in"><span><span class="co">#   alpha level, and overall group size, simulation may </span></span></span>
<span class="r-in"><span><span class="co">#   be necessary in order to generate the vector of individual</span></span></span>
<span class="r-in"><span><span class="co">#   probabilities. This is done using p.vec.func() and </span></span></span>
<span class="r-in"><span><span class="co">#   requires the user to set a seed in order to reproduce </span></span></span>
<span class="r-in"><span><span class="co">#   results.</span></span></span>
<span class="r-in"><span><span class="co"># This example takes approximately 2.5 minutes to run.</span></span></span>
<span class="r-in"><span><span class="co"># Estimated running time was calculated using a </span></span></span>
<span class="r-in"><span><span class="co">#   computer with 16 GB of RAM and one core of an </span></span></span>
<span class="r-in"><span><span class="co">#   Intel i7-6500U processor.</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">52613</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">OTC</span><span class="op">(</span>algorithm<span class="op">=</span><span class="st">"ID2"</span>, p<span class="op">=</span><span class="fl">0.01</span>, Se<span class="op">=</span><span class="fl">0.95</span>, Sp<span class="op">=</span><span class="fl">0.95</span>, group.sz<span class="op">=</span><span class="fl">50</span>,</span></span>
<span class="r-in"><span>obj.fn<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ET"</span>, <span class="st">"MAR"</span>, <span class="st">"GR"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>weights<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>nrow<span class="op">=</span><span class="fl">3</span>, ncol<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Find the OTC over all possible</span></span></span>
<span class="r-in"><span><span class="co">#   testing configurations for a specified group size for</span></span></span>
<span class="r-in"><span><span class="co">#   non-informative three-stage hierarchical testing</span></span></span>
<span class="r-in"><span><span class="co"># This example takes approximately 1 second to run.</span></span></span>
<span class="r-in"><span><span class="co"># Estimated running time was calculated using a </span></span></span>
<span class="r-in"><span><span class="co">#   computer with 16 GB of RAM and one core of an </span></span></span>
<span class="r-in"><span><span class="co">#   Intel i7-6500U processor.</span></span></span>
<span class="r-in"><span><span class="fu">OTC</span><span class="op">(</span>algorithm<span class="op">=</span><span class="st">"D3"</span>, p<span class="op">=</span><span class="fl">0.001</span>, Se<span class="op">=</span><span class="fl">0.95</span>, Sp<span class="op">=</span><span class="fl">0.95</span>, group.sz<span class="op">=</span><span class="fl">18</span>,</span></span>
<span class="r-in"><span>obj.fn<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ET"</span>, <span class="st">"MAR"</span>, <span class="st">"GR"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>weights<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">1</span>, ncol<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> You have specified an overall probability of disease. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  A probability vector will be generated based on the algorithm specified.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A single group size was provided. The optimal testing configuration will be found </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  over all possible testing configurations for the specified group size.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Non-informative Testing - alpha will be ignored. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Algorithm: Non-informative three-stage hierarchical testing </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 18 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of minutes running: 0.00425 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Sp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$OTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$OTC$Stage1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$OTC$Stage2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9 9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$p.vec</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] 0.001 0.001 0.001 0.001 0.001 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$ET</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.32954</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.07386334</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$PSe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.857375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$PSp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9994962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$PPPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6301345</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$PNPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9998572</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$OTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$OTC$Stage1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$OTC$Stage2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9 9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$p.vec</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] 0.001 0.001 0.001 0.001 0.001 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$ET</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.32954</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.07391107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$PSe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.857375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$PSp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9994962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$PPPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6301345</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$PNPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9998572</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1$OTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1$OTC$Stage1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1$OTC$Stage2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9 9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1$p.vec</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] 0.001 0.001 0.001 0.001 0.001 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1$ET</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.32954</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1$value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.07450921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1$PSe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.857375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1$PSp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9994962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1$PPPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6301345</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1$PNPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9998572</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Find the OTC for non-informative</span></span></span>
<span class="r-in"><span><span class="co">#   three-stage hierarchical testing</span></span></span>
<span class="r-in"><span><span class="co"># This example takes approximately 20 seconds to run.</span></span></span>
<span class="r-in"><span><span class="co"># Estimated running time was calculated using a </span></span></span>
<span class="r-in"><span><span class="co">#   computer with 16 GB of RAM and one core of an </span></span></span>
<span class="r-in"><span><span class="co">#   Intel i7-6500U processor.</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu">OTC</span><span class="op">(</span>algorithm<span class="op">=</span><span class="st">"D3"</span>, p<span class="op">=</span><span class="fl">0.06</span>, Se<span class="op">=</span><span class="fl">0.90</span>, Sp<span class="op">=</span><span class="fl">0.90</span>, </span></span>
<span class="r-in"><span>group.sz<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">30</span>, obj.fn<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ET"</span>, <span class="st">"MAR"</span>, <span class="st">"GR"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>weights<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>nrow<span class="op">=</span><span class="fl">3</span>, ncol<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Find the OTC over all possible configurations </span></span></span>
<span class="r-in"><span><span class="co">#   for a specified group size, given a </span></span></span>
<span class="r-in"><span><span class="co">#   heterogeneous vector of probabilities.</span></span></span>
<span class="r-in"><span><span class="co"># This example takes less than 1 second to run.</span></span></span>
<span class="r-in"><span><span class="co"># Estimated running time was calculated using a </span></span></span>
<span class="r-in"><span><span class="co">#   computer with 16 GB of RAM and one core of an </span></span></span>
<span class="r-in"><span><span class="co">#   Intel i7-6500U processor.</span></span></span>
<span class="r-in"><span><span class="fu">OTC</span><span class="op">(</span>algorithm<span class="op">=</span><span class="st">"ID3"</span>, probabilities<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.012</span>, <span class="fl">0.014</span>, <span class="fl">0.011</span>, </span></span>
<span class="r-in"><span><span class="fl">0.012</span>, <span class="fl">0.010</span>, <span class="fl">0.015</span><span class="op">)</span>, Se<span class="op">=</span><span class="fl">0.99</span>, Sp<span class="op">=</span><span class="fl">0.99</span>, group.sz<span class="op">=</span><span class="fl">6</span>, </span></span>
<span class="r-in"><span>obj.fn<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ET"</span>,<span class="st">"MAR"</span>,<span class="st">"GR"</span><span class="op">)</span>, weights<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>nrow<span class="op">=</span><span class="fl">1</span>, ncol<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> You have specified a vector containing individual probabilities of disease.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A single group size was provided. The optimal testing configuration will be found </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  over all possible testing configurations for the specified group size.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Algorithm: Informative three-stage hierarchical testing </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial Group Size = 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of minutes running: 8.333333e-05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.012 0.014 0.011 0.012 0.010 0.015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Sp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$OTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$OTC$Stage1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$OTC$Stage2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$p.vec</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.010 0.011 0.012 0.012 0.014 0.015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$ET</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.378195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2296991</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$PSe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.970299</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$PSp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9997553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$PPPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.980204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$PNPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9996292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$OTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$OTC$Stage1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$OTC$Stage2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$p.vec</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.010 0.011 0.012 0.012 0.014 0.015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$ET</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.378195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2298388</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$PSe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.970299</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$PSp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9997553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$PPPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.980204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$PNPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9996292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1$OTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1$OTC$Stage1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1$OTC$Stage2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1$p.vec</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.010 0.011 0.012 0.012 0.014 0.015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1$ET</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.378195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1$value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2303071</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1$PSe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.970299</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1$PSp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9997553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1$PPPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.980204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.GR1$PNPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9996292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate the operating characteristics for a specified array size</span></span></span>
<span class="r-in"><span><span class="co">#   for non-informative array testing without master pooling</span></span></span>
<span class="r-in"><span><span class="co"># This example takes less than 1 second to run.</span></span></span>
<span class="r-in"><span><span class="co"># Estimated running time was calculated using a </span></span></span>
<span class="r-in"><span><span class="co">#   computer with 16 GB of RAM and one core of an </span></span></span>
<span class="r-in"><span><span class="co">#   Intel i7-6500U processor.</span></span></span>
<span class="r-in"><span><span class="fu">OTC</span><span class="op">(</span>algorithm<span class="op">=</span><span class="st">"A2"</span>, p<span class="op">=</span><span class="fl">0.005</span>, Se<span class="op">=</span><span class="fl">0.95</span>, Sp<span class="op">=</span><span class="fl">0.95</span>, group.sz<span class="op">=</span><span class="fl">8</span>, </span></span>
<span class="r-in"><span>obj.fn<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ET"</span>, <span class="st">"MAR"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> You have specified an overall probability of disease. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  A probability vector will be generated based on the algorithm specified.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A single group size was provided. No optimization will be performed.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Non-informative Testing - alpha will be ignored. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Algorithm: Non-informative square array testing without master pooling </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Row/Column Size=8, Array Size=64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of minutes running: 0.002016667 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Sp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$OTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$OTC$Array.dim</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$OTC$Array.sz</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$p.mat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7,] 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8,] 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$ET</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 19.96432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3119425</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$PSe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.905697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$PSp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9971268</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$PPPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.613012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.ET$PNPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.999525</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$OTC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$OTC$Array.dim</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$OTC$Array.sz</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$p.mat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7,] 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8,] 0.005 0.005 0.005 0.005 0.005 0.005 0.005 0.005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$ET</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 19.96432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3129849</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$PSe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.905697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$PSp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9971268</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$PPPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.613012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $opt.MAR$PNPV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.999525</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Find the OTC for informative array testing without </span></span></span>
<span class="r-in"><span><span class="co">#   master pooling</span></span></span>
<span class="r-in"><span><span class="co"># A vector of individual probabilities is generated using</span></span></span>
<span class="r-in"><span><span class="co">#   the expected value of order statistics from a beta </span></span></span>
<span class="r-in"><span><span class="co">#   distribution with p = 0.03 and a heterogeneity level </span></span></span>
<span class="r-in"><span><span class="co">#   of alpha = 2. The probabilities are then arranged in </span></span></span>
<span class="r-in"><span><span class="co">#   a matrix using the gradient method described in </span></span></span>
<span class="r-in"><span><span class="co">#   McMahan et al. (2012b). Depending on the specified </span></span></span>
<span class="r-in"><span><span class="co">#   probability, alpha level, and overall group size, </span></span></span>
<span class="r-in"><span><span class="co">#   simulation may be necessary in order to generate the </span></span></span>
<span class="r-in"><span><span class="co">#   vector of individual probabilities. This is done using </span></span></span>
<span class="r-in"><span><span class="co">#   p.vec.func() and requires the user to set a </span></span></span>
<span class="r-in"><span><span class="co">#   seed in order to reproduce results.</span></span></span>
<span class="r-in"><span><span class="co"># This example takes approximately 30 seconds to run.</span></span></span>
<span class="r-in"><span><span class="co"># Estimated running time was calculated using a </span></span></span>
<span class="r-in"><span><span class="co">#   computer with 16 GB of RAM and one core of an </span></span></span>
<span class="r-in"><span><span class="co">#   Intel i7-6500U processor.</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1002</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">OTC</span><span class="op">(</span>algorithm<span class="op">=</span><span class="st">"IA2"</span>, p<span class="op">=</span><span class="fl">0.03</span>, Se<span class="op">=</span><span class="fl">0.95</span>, Sp<span class="op">=</span><span class="fl">0.95</span>, </span></span>
<span class="r-in"><span>group.sz<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">20</span>, obj.fn<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ET"</span>, <span class="st">"MAR"</span>, <span class="st">"GR"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>weights<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>nrow<span class="op">=</span><span class="fl">3</span>, ncol<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Find the OTC for non-informative array testing </span></span></span>
<span class="r-in"><span><span class="co">#   with master pooling</span></span></span>
<span class="r-in"><span><span class="co"># This example takes approximately 20 seconds to run.</span></span></span>
<span class="r-in"><span><span class="co"># Estimated running time was calculated using a </span></span></span>
<span class="r-in"><span><span class="co">#   computer with 16 GB of RAM and one core of an </span></span></span>
<span class="r-in"><span><span class="co">#   Intel i7-6500U processor.</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu">OTC</span><span class="op">(</span>algorithm<span class="op">=</span><span class="st">"A2M"</span>, p<span class="op">=</span><span class="fl">0.02</span>, Se<span class="op">=</span><span class="fl">0.90</span>, Sp<span class="op">=</span><span class="fl">0.90</span>, </span></span>
<span class="r-in"><span>group.sz<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">20</span>, obj.fn<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ET"</span>, <span class="st">"MAR"</span>, <span class="st">"GR"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>weights<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">2</span>, <span class="fl">2</span>, </span></span>
<span class="r-in"><span><span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">10</span>, <span class="fl">100</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">6</span>, ncol<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Boan Zhang, Christopher Bilder, Brad Biggerstaff, Frank Schaarschmidt, Brianna Hitt.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

