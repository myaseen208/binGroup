<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Iterate Group Size for a One-Parameter Group Testing Problem — sDesign • binGroup</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Iterate Group Size for a One-Parameter Group Testing Problem — sDesign"><meta property="og:description" content="Increasing of group size s for a fixed number of groups n in a binomial group testing design,
until a pre-specified power is achieved. Control of bias during iteration. A hypothetical
threshold proportion p.hyp and the absolute difference delta to be detected have to be specified."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">binGroup</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Iterate Group Size for a One-Parameter Group Testing Problem</h1>
    
    <div class="hidden name"><code>sDesign.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Increasing of group size s for a fixed number of groups n in a binomial group testing design,
until a pre-specified power is achieved. Control of bias during iteration. A hypothetical
threshold proportion <kbd>p.hyp</kbd> and the absolute difference <kbd>delta</kbd> to be detected have to be specified.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sDesign</span><span class="op">(</span><span class="va">n</span>, <span class="va">smax</span>, <span class="va">delta</span>, <span class="va">p.hyp</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span> power <span class="op">=</span> <span class="fl">0.8</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span>, method <span class="op">=</span> <span class="st">"CP"</span>, biasrest <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>n</dt>
<dd><p>integer, fixed sample size (number of assays)</p></dd>

  <dt>smax</dt>
<dd><p>integer, maximal group size allowed in planning of the design</p></dd>

  <dt>delta</dt>
<dd><p>absolute difference between the threshold and the true proportion which shall be detectable with specified power</p></dd>

  <dt>p.hyp</dt>
<dd><p>threshold proportion to test against in the hypothesis, specify as a value between 0 and 1</p></dd>

  <dt>conf.level</dt>
<dd><p>confidence level of the decision, default is 0.95</p></dd>

  <dt>power</dt>
<dd><p>level of power to be achieved to be specified as a probability between 0 and 1</p></dd>

  <dt>alternative</dt>
<dd><p>character string, defining the alternative hypothesis, either 'two.sided', 'less' or 'greater'
where <kbd>'less'</kbd> calculates the probability that p.hyp is excluded by an upper confidence limit for a true proportion <kbd>p.hyp</kbd> - <kbd>delta</kbd>,
<kbd>'greater'</kbd> calculates the probability that p.hyp is excluded by a lower confidence limit for a true proportion of <kbd>p.hyp</kbd> + <kbd>delta</kbd> .
<kbd>'two.sided'</kbd> calculates min(power(<kbd>p.hyp</kbd> - <kbd>delta</kbd>, <kbd>p.hyp</kbd> + <kbd>delta</kbd>)) for a two.sided CI, thus can result in much lower power.
Note that coverage probability and power are not necessarily symmetric for upper and lower bound of binomial CI.</p></dd>


  <dt>method</dt>
<dd><p>character string specifying the CImethod to be used for evaluation, see argument <kbd>method</kbd> in <code><a href="bgtCI.html">bgtCI</a></code></p></dd>

  <dt>biasrest</dt>
<dd><p>value between 0 and 1 specifying the absolute bias maximally allowed</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The power of a confidence interval here is defined as the probability that a confidence interval or limit excludes the threshold parameter (p.hyp) of the hypothesis. 
This function increases size of groups (number of units in a bulk sample) until a pre-specified power is reached.
Since the power does not increase monotone with increasing s for binomial proportions but oscillates between local maxima and minima, 
the simple iteration given here will generally result in selecting those s, for which the given CI method shows a local minimum of 
coverage if the null hypothesis is true.
Since the positive bias of the estimator in group testing increases with increasing group size, it is checked whether bias is smaller than a 
pre-specified value (bias.rest). If bias violates this restriction for a given combination n, s, delta, s will not be further increased the
actual power of the last acceptable group size s is returned.</p>
 

    </div>
    <div id="value">
    <h2>Value</h2>
    <p>A list containing:</p>
<dl><dt>sout </dt>
<dd><p>the group size necessary to met the conditions</p></dd>

  <dt>powerout </dt>
<dd><p>the exact power for the specified parameters and the group size</p></dd>

  <dt>biasout </dt>
<dd><p>the bias for the specified parameters and the iterated group size</p></dd>

</dl><p>and a number of values specified in the function call or produced in the iteration.</p>


    </div>
    <div id="references">
    <h2>References</h2>
     

<p><em>Schaarschmidt F (2007)</em> Experimental design for one-sided confidence intervals or hypothesis tests in binomial group testing. <em>Communications in Biometry and Crop Science 2 (1), 32-40.</em>
 http://agrobiol.sggw.waw.pl/cbcs/</p>
<p><em>Swallow WH (1985)</em> Group testing for estimating infection rates and probabilities of disease transmission. <em>Phytopathology 75 (8), 882-889.</em></p>
<p></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="plot.bgtDesign.html">plot.sDesign</a></code> can be used to plot th iteration of this function</p>
<p><code><a href="bgtPower.html">bgtPower</a></code>: calculation of power and bias depending on n, s, delta, p.hyp, conf.level, method
<code><a href="nDesign.html">nDesign</a></code>:  function to iteratively optimize sample size(number of groups)n for a given group size s
<code><a href="estDesign.html">estDesign</a></code>:  function to choose group size s according to the minimal mse of the estimator, as given in Swallow (1985)</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Assume that objective is to show that a proportion</span></span></span>
<span class="r-in"><span><span class="co">## is smaller than 0.005 (i.e. 0.5%) with a </span></span></span>
<span class="r-in"><span><span class="co">## power of 0.80 (i.e. 80%) if the unknown proportion</span></span></span>
<span class="r-in"><span><span class="co">## in the population is 0.003 (i.e. 0.3%), thus a </span></span></span>
<span class="r-in"><span><span class="co">## delta = 0.002 shall be detected. A 95-per-cent </span></span></span>
<span class="r-in"><span><span class="co">## Clopper-Pearson CI (corresponding to an exact test)</span></span></span>
<span class="r-in"><span><span class="co">## shall be used. The maximal number of groups might </span></span></span>
<span class="r-in"><span><span class="co">## be 30 where the assay sensitivity is not limited </span></span></span>
<span class="r-in"><span><span class="co">## until groupsize s = 100.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">sDesign</span><span class="op">(</span>smax<span class="op">=</span><span class="fl">100</span>, n<span class="op">=</span><span class="fl">30</span>, delta<span class="op">=</span><span class="fl">0.002</span>, p.hyp<span class="op">=</span><span class="fl">0.005</span>,</span></span>
<span class="r-in"><span> alternative<span class="op">=</span><span class="st">"less"</span>, method<span class="op">=</span><span class="st">"CP"</span>, power<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Power was not reached in the range of s = 2 , 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximal power was reached for s = 100 with power = 0.4662 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> and bias = 5.957802e-05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true proportion is less than 0.005 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assumed true proportion = 0.003 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## One might accept to detect delta=0.004,</span></span></span>
<span class="r-in"><span><span class="co">## i.e. accepting to reject H0: p&gt;=0.005 with </span></span></span>
<span class="r-in"><span><span class="co">## power 80 per cent when the true proportion is 0.001:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">sDesign</span><span class="op">(</span>smax<span class="op">=</span><span class="fl">100</span>, n<span class="op">=</span><span class="fl">30</span>, delta<span class="op">=</span><span class="fl">0.004</span>, p.hyp<span class="op">=</span><span class="fl">0.005</span>,</span></span>
<span class="r-in"><span> alternative<span class="op">=</span><span class="st">"less"</span>, method<span class="op">=</span><span class="st">"CP"</span>, power<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Power was reached without violating bias restriction </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> for s = 44 with power = 0.8626 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> and bias = 1.704e-05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true proportion is less than 0.005 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assumed true proportion = 0.001 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">sDesign</span><span class="op">(</span>smax<span class="op">=</span><span class="fl">100</span>, n<span class="op">=</span><span class="fl">30</span>, delta<span class="op">=</span><span class="fl">0.004</span>, p.hyp<span class="op">=</span><span class="fl">0.005</span>,</span></span>
<span class="r-in"><span> alternative<span class="op">=</span><span class="st">"less"</span>, method<span class="op">=</span><span class="st">"Score"</span>, power<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Power was reached without violating bias restriction </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> for s = 41 with power = 0.8819 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> and bias = 1.698e-05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true proportion is less than 0.005 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assumed true proportion = 0.001 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Boan Zhang, Christopher Bilder, Brad Biggerstaff, Frank Schaarschmidt, Brianna Hitt.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

