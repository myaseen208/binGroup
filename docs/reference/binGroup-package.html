<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Statistical Methods for Group Testing. — binGroup-package • binGroup</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Statistical Methods for Group Testing. — binGroup-package"><meta property="og:description" content="This package provides methods for estimation and hypothesis testing of proportions in group testing designs. It involves methods for estimating a proportion in a single population (assuming sensitivity and specificity 1 in designs with equal group sizes), as well as hypothesis tests and functions for experimental design for this situation. For estimating one proportion or the difference of proportions, a number of confidence interval methods are included, which can deal with various different pool sizes. Further, regression methods are implemented for simple pooling and matrix pooling designs.  
This package also provides methods for identification of positive items in a number of group testing algorithms. Optimal testing configurations can be found for hierarchical and array-based algorithms. Operating characteristics can be calculated for testing configurations across a wide variety of situations."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">binGroup</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Statistical Methods for Group Testing.</h1>
    
    <div class="hidden name"><code>binGroup-package.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This package provides methods for estimation and hypothesis testing of proportions in group testing designs. It involves methods for estimating a proportion in a single population (assuming sensitivity and specificity 1 in designs with equal group sizes), as well as hypothesis tests and functions for experimental design for this situation. For estimating one proportion or the difference of proportions, a number of confidence interval methods are included, which can deal with various different pool sizes. Further, regression methods are implemented for simple pooling and matrix pooling designs. <br><br>
This package also provides methods for identification of positive items in a number of group testing algorithms. Optimal testing configurations can be found for hierarchical and array-based algorithms. Operating characteristics can be calculated for testing configurations across a wide variety of situations.</p>
    </div>


    <div id="details">
    <h2>Details</h2>
    
<table class="table table"><tr><td>Package:</td><td>binGroup</td></tr><tr><td>Type:</td><td>Package</td></tr><tr><td>Version:</td><td>2.2-1</td></tr><tr><td>Date:</td><td>2018-07-07</td></tr><tr><td>License:</td><td>GPL (&gt;=3)</td></tr><tr><td>LazyLoad:</td><td>no</td></tr></table><p>1) One-sample case</p>
<p>Methods for calculating confidence intervals for a single population proportion from designs with equal group sizes (as described by Tebbs and Bilder, 2004 and Schaarschmidt, 2007) are implemented in the function <code><a href="bgtCI.html">bgtCI</a></code>.</p>
<p>For the problem of choosing an adequate experimental design in the one-sample case with only one group size, the functions <code><a href="estDesign.html">estDesign</a></code>, <code><a href="sDesign.html">sDesign</a></code>, <code><a href="nDesign.html">nDesign</a></code> implement different iterative approaches, as examplified by Swallow (1985) and Schaarschmidt (2007).</p>
<p>If a confidence interval for a single proportion shall be calculated based on a design involving groups of different group sizes, a number of methods described by Hepworth (1999) is available in the function <code><a href="pooledBin.html">pooledBin</a></code>. The exact method described by Hepworth (1996) is implemented in the function <code><a href="bgtvs.html">bgtvs</a></code>.</p>
<p>2) Two-sample case</p>
<p>The function <code><a href="pooledBinDiff.html">pooledBinDiff</a></code> provides a number of confidence interval methods for estimating the difference of proportions from two independent samples, allowing for groups of different group size (Biggerstaff, 2008).</p>
<p>3) Regression models</p>
<p>Two approaches (by Vansteelandt et al., 2000 and Xie, 2001) to estimate parameters of group testing regression models can be applied by calling <code><a href="gtreg.html">gtreg</a></code>. Once fitted, corresponding methods to extract residuals, calculate predictions and summarize the parameter estimates (including hypotheses tests) are available in the S3 methods <code><a href="residuals.gt.html">residuals.gt</a></code>, <code><a href="predict.gt.html">predict.gt</a></code> and <code><a href="summary.gt.html">summary.gt</a></code>.</p>
<p>Group testing regression models in settings with matrix pooling (Xie, 2001) can be fit using <code><a href="gtreg.mp.html">gtreg.mp</a></code>.</p>
<p>4) Identification using hierarchical and array-based group testing algorithms</p>
<p>The function <code><a href="OTC.html">OTC</a></code> implements a number of group testing algorithms, described in Hitt et al. (2018), which calculate the operating characteristics and find the optimal testing configuration over a range of possible initial pool sizes and/or testing configurations (sets of subsequent pool sizes).</p>



    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Boan Zhang, Christopher Bilder, Brad Biggerstaff, Brianna Hitt, Frank Schaarschmidt</p>
<p>Maintainer: Frank Schaarschmidt &lt;schaarschmidt@biostat.uni-hannover.de&gt;</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p><em>Biggerstaff, B.J. (2008)</em>: Confidence interval for the difference of proportions estmimated from pooled samples. <em>Journal of Agricultural Biological and Environmental Statistics, 13(4), 478-496.</em></p>
<p><em>Hepworth, G. (1996)</em> Exact confidence intervals for proportions estimated by group testing. <em>Biometrics 52, 1134-1146.</em></p>
<p><em>Hepworth, G. (1999)</em>: <em>Estimation of proportions by group testing.</em> PhD Dissertation. Melbourne, Australia: The University of Melbourne.</p>
<p><em>Hitt, B., Bilder, C., Tebbs, J. &amp; McMahan, C. (2018)</em> The Optimal Group Size Controversy for Infectious Disease Testing: Much Ado About Nothing?!. Manuscript submitted for publication. http://www.chrisbilder.com/grouptesting</p>
<p><em>Schaarschmidt, F. (2007)</em> Experimental design for one-sided confidence intervals or hypothesis tests in binomial group testing.  <em>Communications in Biometry and Crop Science 2 (1), 32-40.</em> http://agrobiol.sggw.waw.pl/cbcs/</p>
<p><em>Swallow, W.H. (1985)</em> Group testing for estimating infection rates and probabilities of disease transmission.  <em>Phytopathology 75 (8), 882-889.</em></p>
<p><em>Tebbs, J.M. &amp; Bilder, C.R. (2004)</em> Confidence interval procedures for the probability of disease transmission in multiple-vector-transfer designs.  <em>Journal of Agricultural, Biological and Environmental Statistics 9 (1), 75-90.</em></p>
<p><em>Vansteelandt, S., Goetghebeur, E., and Verstraeten, T. (2000)</em> Regression models for disease prevalence with diagnostic tests on pools of serum samples, <em>Biometrics, 56, 1126-1133.</em></p>
<p><em>Xie, M. (2001)</em> Regression analysis of group testing samples, <em>Statistics in Medicine, 20, 1957-1969.</em></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 1) One-sample problem</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 1.1) Confidence intervals for designs with equal group size (pool size),</span></span></span>
<span class="r-in"><span><span class="co"># where </span></span></span>
<span class="r-in"><span><span class="co">#  n denotes the number of groups (pools),</span></span></span>
<span class="r-in"><span><span class="co">#  s denotes the common group size (number of individuals pooled per group),</span></span></span>
<span class="r-in"><span><span class="co">#  y denotes the number of groups tested positive.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The following call reproduces the example given </span></span></span>
<span class="r-in"><span><span class="co"># by Tebbs and Bilder (2004) for the two-sided 95-percent </span></span></span>
<span class="r-in"><span><span class="co"># exact (Clopper-Pearson) interval:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="bgtCI.html">bgtCI</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">24</span>, y<span class="op">=</span><span class="fl">3</span>, s<span class="op">=</span><span class="fl">7</span>, conf.level<span class="op">=</span><span class="fl">0.95</span>,</span></span>
<span class="r-in"><span> alternative<span class="op">=</span><span class="st">"two.sided"</span>, method<span class="op">=</span><span class="st">"CP"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent CP confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [ 0.003838, 0.05432 ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Point estimate: 0.0189 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 1.2) Confidence intervals for designs with unequal group size (pool size):</span></span></span>
<span class="r-in"><span><span class="co"># Keeping notation as above but allowing for (a limited number of) different</span></span></span>
<span class="r-in"><span><span class="co"># group size s, the examples given in Hepworth (1996), Table 5 can be </span></span></span>
<span class="r-in"><span><span class="co"># reproduced by calling:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu"><a href="bgtvs.html">bgtvs</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, s<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Input </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of groups             2    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> group size                   5    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of positive groups    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Exact 95 percent confidence interval </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0000 0.2059</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Point estimate: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-in"><span> <span class="fu"><a href="bgtvs.html">bgtvs</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, s<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Input </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of groups             2    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> group size                   5    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of positive groups    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Exact 95 percent confidence interval </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.001581 0.266743</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Point estimate: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.06459</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The function pooledBin provides different methods for the same problem,</span></span></span>
<span class="r-in"><span><span class="co"># where x is the number of positive groups, m is the size of the groups and</span></span></span>
<span class="r-in"><span><span class="co"># n is the number of groups with the correesponding sizes:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="pooledBin.html">pooledBin</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, m<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">)</span>, n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, ci.method<span class="op">=</span><span class="st">"score"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PointEst    Lower    Upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.0592   0.0114   0.2410 </span>
<span class="r-in"><span><span class="fu"><a href="pooledBin.html">pooledBin</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, m<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">)</span>, n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, ci.method<span class="op">=</span><span class="st">"lrt"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PointEst    Lower    Upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.0592   0.0038   0.2553 </span>
<span class="r-in"><span><span class="fu"><a href="pooledBin.html">pooledBin</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, m<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">)</span>, n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, ci.method<span class="op">=</span><span class="st">"bc-skew-score"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PointEst    Lower    Upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.0592   0.0038   0.2499 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 1.3) For experimental design based on the bias of the point estimate,</span></span></span>
<span class="r-in"><span><span class="co"># as proposed by Swallow (1985): The values in Table 1 (Swallow, 1985),</span></span></span>
<span class="r-in"><span><span class="co"># p.885 can be reproduced by calling:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="estDesign.html">estDesign</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span>, smax<span class="op">=</span><span class="fl">100</span>, p.tr<span class="op">=</span><span class="fl">0.001</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  minimal mse(p) is achieved with group size s &gt;= smax </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $varp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.198715e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mse</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.201888e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bias</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5.63273e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $exp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.001056327</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="estDesign.html">estDesign</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span>, smax<span class="op">=</span><span class="fl">100</span>, p.tr<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> group size s with minimal mse(p) = 33 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $varp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4.539192e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mse</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4.580377e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bias</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0006417578</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $exp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.01064176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2) Two-sample comparison</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Assume a design, where pools 5, 1, 1, 30, and 20 pools of size 10, 4, 1, 25, 50, </span></span></span>
<span class="r-in"><span><span class="co"># respectively, are used to estimate the prevalence in two populations.</span></span></span>
<span class="r-in"><span><span class="co"># In population 1, one out of 5 pools with 10 units is positive,</span></span></span>
<span class="r-in"><span><span class="co"># while in population 2, two out of five pools with 10 units is positive as well as </span></span></span>
<span class="r-in"><span><span class="co"># the one pool with only 1 unit.</span></span></span>
<span class="r-in"><span><span class="co"># The difference of proportions is to be estimated.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">25</span>,<span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">30</span>,<span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">25</span>,<span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">30</span>,<span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="pooledBinDiff.html">pooledBinDiff</a></span><span class="op">(</span>x1<span class="op">=</span><span class="va">x1</span>, m1<span class="op">=</span><span class="va">m1</span>,x2<span class="op">=</span><span class="va">x2</span>, m2<span class="op">=</span><span class="va">m2</span>, n1<span class="op">=</span><span class="va">n1</span>, n2<span class="op">=</span><span class="va">n2</span>, ci.method<span class="op">=</span><span class="st">"lrt"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PointEst    Lower    Upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -0.0011  -0.0039   0.0012 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 3) Regression models</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 3.1) Fitting a regression model</span></span></span>
<span class="r-in"><span><span class="co"># A HIV surveillance data (used by Vansteelandt et al. 2000)</span></span></span>
<span class="r-in"><span><span class="co"># can be analysed for the dependence of HIV prevalence</span></span></span>
<span class="r-in"><span><span class="co"># on covariates AGE and EDUC., with sensitivity and specificity</span></span></span>
<span class="r-in"><span><span class="co"># assumed to be 0.9 each.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">hivsurv</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="gtreg.html">gtreg</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">groupres</span> <span class="op">~</span> <span class="va">AGE</span> <span class="op">+</span> <span class="va">EDUC.</span>, data <span class="op">=</span> <span class="va">hivsurv</span>,</span></span>
<span class="r-in"><span>  groupn <span class="op">=</span> <span class="va">gnum</span>, sens <span class="op">=</span> <span class="fl">0.9</span>, spec <span class="op">=</span> <span class="fl">0.9</span>, method <span class="op">=</span> <span class="st">"Xie"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of minutes running: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gtreg(formula = groupres ~ AGE + EDUC., data = hivsurv, groupn = gnum, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sens = 0.9, spec = 0.9, method = "Xie")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Deviance Residuals: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min       1Q   Median       3Q      Max  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.1729  -0.9406  -0.8281   1.3386   1.6497  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error z value Pr(&gt;|z|)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -3.11976    1.84816  -1.688   0.0914 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AGE         -0.05692    0.07777  -0.732   0.4642  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EDUC.        0.82833    0.50717   1.633   0.1024  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Null deviance: 154.3  on 85  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual deviance: 109.5  on 83  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 115.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of iterations in EM: 43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 3.2) Fitting a regression model for matrix pooling data</span></span></span>
<span class="r-in"><span><span class="co"># The function sim.mp is used to simulate a matrix pooling data set:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">9128</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sa1a</span><span class="op">&lt;-</span><span class="fu"><a href="sim.mp.html">sim.mp</a></span><span class="op">(</span>par<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7</span>,<span class="fl">0.1</span><span class="op">)</span>, n.row<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span><span class="op">)</span>, n.col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> sens<span class="op">=</span><span class="fl">0.95</span>, spec<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">sa1a</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ dframe:'data.frame':	50 obs. of  7 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ x       : num [1:50] 30 61.3 34.3 46.2 39.4 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ col.resp: num [1:50] 0 0 0 0 0 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ row.resp: num [1:50] 0 1 1 0 1 0 1 1 0 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ coln    : num [1:50] 1 1 1 1 1 2 2 2 2 2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ rown    : num [1:50] 1 2 3 4 5 1 2 3 4 5 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ arrayn  : int [1:50] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ retest  : num [1:50] NA NA NA NA NA NA 0 0 NA 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ ind   :List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : int [1:5, 1:6] 0 0 0 0 0 0 0 0 0 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ : int [1:4, 1:5] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ prob  : num [1:50] 0.0179 0.2949 0.0273 0.0846 0.045 ...</span>
<span class="r-in"><span><span class="va">sa1</span><span class="op">&lt;-</span><span class="va">sa1a</span><span class="op">$</span><span class="va">dframe</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="gtreg.mp.html">gtreg.mp</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">col.resp</span>, <span class="va">row.resp</span><span class="op">)</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">sa1</span>, </span></span>
<span class="r-in"><span>                 coln <span class="op">=</span> <span class="va">coln</span>, rown <span class="op">=</span> <span class="va">rown</span>, arrayn <span class="op">=</span> <span class="va">arrayn</span>, </span></span>
<span class="r-in"><span>                 sens <span class="op">=</span> <span class="fl">0.95</span>, spec <span class="op">=</span> <span class="fl">0.95</span>, n.gibbs <span class="op">=</span> <span class="fl">2000</span>, trace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit2</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 4) Identification using hierarchical and array-based group testing algorithms</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 4.1) Finding the optimal testing configuration over a range of initial </span></span></span>
<span class="r-in"><span><span class="co"># group sizes, using non-informative three-stage hierarchical testing, where </span></span></span>
<span class="r-in"><span><span class="co">#   p denotes the overall prevalence of disease,</span></span></span>
<span class="r-in"><span><span class="co">#   Se denotes the sensitivity of the diagnostic test, </span></span></span>
<span class="r-in"><span><span class="co">#   Sp denotes the specificity of the diagnostic test,</span></span></span>
<span class="r-in"><span><span class="co">#   group.sz denotes the range of initial pool sizes for consideration, and</span></span></span>
<span class="r-in"><span><span class="co">#   obj.fn specifies the objective functions for which to find results.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The following call reproduces results given by Hitt et al. (2018) for </span></span></span>
<span class="r-in"><span><span class="co"># informative three-stage hierarchical testing with an overall disease </span></span></span>
<span class="r-in"><span><span class="co"># prevalence of E(p_i) = 0.01 and sensitivity and specificity equal to 0.95.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This example takes approximately 2.5 minutes to run.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1002</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">results1</span> <span class="op">&lt;-</span> <span class="fu"><a href="OTC.html">OTC</a></span><span class="op">(</span>algorithm<span class="op">=</span><span class="st">"ID3"</span>, p<span class="op">=</span><span class="fl">0.01</span>, Se<span class="op">=</span><span class="fl">0.95</span>, Sp<span class="op">=</span><span class="fl">0.95</span>, group.sz<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">40</span>, </span></span>
<span class="r-in"><span>obj.fn<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ET"</span>, <span class="st">"MAR"</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">results1</span><span class="op">$</span><span class="va">opt.ET</span><span class="op">$</span><span class="va">OTC</span></span></span>
<span class="r-in"><span><span class="va">results1</span><span class="op">$</span><span class="va">opt.ET</span><span class="op">$</span><span class="va">ET</span><span class="op">/</span><span class="va">results1</span><span class="op">$</span><span class="va">opt.ET</span><span class="op">$</span><span class="va">OTC</span><span class="op">$</span><span class="va">Stage1</span></span></span>
<span class="r-in"><span><span class="va">results1</span><span class="op">$</span><span class="va">opt.MAR</span><span class="op">$</span><span class="va">OTC</span></span></span>
<span class="r-in"><span><span class="va">results1</span><span class="op">$</span><span class="va">opt.MAR</span><span class="op">$</span><span class="va">ET</span><span class="op">/</span><span class="va">results1</span><span class="op">$</span><span class="va">opt.MAR</span><span class="op">$</span><span class="va">OTC</span><span class="op">$</span><span class="va">Stage1</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 4.2) Finding the optimal testing configuration using non-informative</span></span></span>
<span class="r-in"><span><span class="co"># array testing without master pooling</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The following call reproduces results given by Hitt et al. (2018) for</span></span></span>
<span class="r-in"><span><span class="co"># non-informative array testing without master pooling with an overall</span></span></span>
<span class="r-in"><span><span class="co"># disease prevalence of p=0.01 and sensitivity and specificity equal </span></span></span>
<span class="r-in"><span><span class="co"># to 0.90.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This example takes approximately 7 minutes to run.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">results2</span> <span class="op">&lt;-</span> <span class="fu"><a href="OTC.html">OTC</a></span><span class="op">(</span>algorithm<span class="op">=</span><span class="st">"A2"</span>, p<span class="op">=</span><span class="fl">0.01</span>, Se<span class="op">=</span><span class="fl">0.90</span>, Sp<span class="op">=</span><span class="fl">0.90</span>, group.sz<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">40</span>, </span></span>
<span class="r-in"><span>obj.fn<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ET"</span>, <span class="st">"MAR"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">results2</span><span class="op">$</span><span class="va">opt.ET</span><span class="op">$</span><span class="va">OTC</span></span></span>
<span class="r-in"><span><span class="va">results2</span><span class="op">$</span><span class="va">opt.ET</span><span class="op">$</span><span class="va">ET</span><span class="op">/</span><span class="va">results2</span><span class="op">$</span><span class="va">opt.ET</span><span class="op">$</span><span class="va">OTC</span><span class="op">$</span><span class="va">Array.sz</span></span></span>
<span class="r-in"><span><span class="va">results2</span><span class="op">$</span><span class="va">opt.MAR</span><span class="op">$</span><span class="va">OTC</span></span></span>
<span class="r-in"><span><span class="va">results2</span><span class="op">$</span><span class="va">opt.MAR</span><span class="op">$</span><span class="va">ET</span><span class="op">/</span><span class="va">results2</span><span class="op">$</span><span class="va">opt.MAR</span><span class="op">$</span><span class="va">OTC</span><span class="op">$</span><span class="va">Array.sz</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Boan Zhang, Christopher Bilder, Brad Biggerstaff, Frank Schaarschmidt, Brianna Hitt.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

