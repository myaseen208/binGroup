<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Confidence intervals for the difference of proportions — pooledBinDiff • binGroup</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Confidence intervals for the difference of proportions — pooledBinDiff"><meta property="og:description" content="The function calculates confidence intervals for the difference of two proportions based on pooled testing experiments containing various different pool sizes."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">binGroup</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Confidence intervals for the difference of proportions</h1>
    
    <div class="hidden name"><code>pooledBinDiff.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function calculates confidence intervals for the difference of two proportions based on pooled testing experiments containing various different pool sizes.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pooledBinDiff</span><span class="op">(</span><span class="va">x1</span>, <span class="va">m1</span>, <span class="va">x2</span>, <span class="va">m2</span>, n1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span><span class="op">)</span>,</span>
<span> n2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span><span class="op">)</span>, </span>
<span> pt.method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"firth"</span>, <span class="st">"gart"</span>, <span class="st">"bc-mle"</span>, <span class="st">"mle"</span>, <span class="st">"mir"</span><span class="op">)</span>, </span>
<span> ci.method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"skew-score"</span>, <span class="st">"bc-skew-score"</span>, <span class="st">"score"</span>, <span class="st">"lrt"</span>, <span class="st">"wald"</span>, <span class="st">"mir"</span><span class="op">)</span>,</span>
<span> scale <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, tol <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">^</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x1</dt>
<dd><p>a vector, specifying the observed number of positive pools, among the number of pools tested (<code>n1</code>) in population 1</p></dd>

  <dt>m1</dt>
<dd><p>a vector of corresponding pool sizes in population 1, must have the same length as <code>x1</code></p></dd>

  <dt>x2</dt>
<dd><p>a vector, specifying the observed number of positive pools, among the number of pools tested (<code>n2</code>) in population 2</p></dd>

  <dt>m2</dt>
<dd><p>a vector of corresponding pool sizes in population 2, must have the same length as <code>x2</code></p></dd>

  <dt>n1</dt>
<dd><p>a vector of the corresponding number of pools with sizes <code>m1</code></p></dd>

  <dt>n2</dt>
<dd><p>a vector of the corresponding number of pools with sizes <code>m2</code></p></dd>

  <dt>pt.method</dt>
<dd><p>a character string, specifying the point estimator to compute, with the following options: <code>"firth"</code>: recommended bias-corrected estimator (Hepworth &amp; Biggerstaff, 2017), the default; <code>"gart"</code> bias-corrected MLE (Biggerstaff, 2008); <code>"bc-mle"</code>: same as <code>"gart"</code>, kept for backward compatibility ; <code>"mle"</code> MLE, and <code>"mir"</code> MIR.</p></dd>

  <dt>ci.method</dt>
<dd><p>a character string, specifying the confidence interval to compute, with options: <code>"skew-score"</code> skewness-corrected, the default, <code>"score"</code> the score, <code>"bc-skew-score"</code> bias- and skewness-corrected 
 <code>"lrt"</code> likelihood ratio test. See Biggerstaff (2008) for details. Further, the options <code>"wald"</code> wald and <code>"mir"</code> MIR are available but are not recommended.</p></dd>

  <dt>scale</dt>
<dd><p>a single numeric, coefficient to scale the point estimates and intervals bounds in the print and summary method (<code><a href="print.poolbindiff.html">print.poolbindiff</a></code>, <code><a href="summary.poolbindiff.html">summary.poolbindiff</a></code>)</p></dd>

  <dt>alpha</dt>
<dd><p>a single numeric, specifying the type-I-error level</p></dd>

  <dt>tol</dt>
<dd><p>accuracy required for iterations in internal functions</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Point estimation: bias preventative ("firth") and bias corrected ("gart") estimators are recommended, with details described in Hepworth G, Biggerstaff BJ (2017). Use of MLE (<code>"mle"</code>), and MIR (<code>"mir"</code>) estimators is not recommended.</p>
<p>Confidence intervals: Note, that the methods "mir" and "wald" can not be recommended, because they return too narrow intervals in relevant situations, "mir" because it ignores the pooling, and "wald" because it relies on simple large sample methods.
 For computational details and simulation results of the remaining methods, see Biggerstaff (2008).</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list with elements</p>
<dl><dt>d</dt>
<dd><p>the estimated difference of proportions</p></dd>

<dt>lcl</dt>
<dd><p>the lower confidence limit</p></dd>

<dt>ucl</dt>
<dd><p>the upper confidence limit</p></dd>

<dt>pt.method</dt>
<dd><p>the method used for point estimation</p></dd>

<dt>ci.method</dt>
<dd><p>the method used for interval estimation</p></dd>

<dt>alpha</dt>
<dd><p>the type-I-error level</p></dd>

<dt>scale</dt>
<dd><p>Scaling coefficient for the output</p></dd>

<dt>x1</dt>
<dd><p>the numbers of postive pools in population 1</p></dd>

<dt>m1</dt>
<dd><p>the size of the pools in population 1</p></dd>

<dt>n1</dt>
<dd><p>the numbers of pools with corresponding pool sizes m1 in population 1</p></dd>

<dt>x2</dt>
<dd><p>the numbers of postive pools in population 2</p></dd>

<dt>m2</dt>
<dd><p>the size of the pools in population 2</p></dd>

<dt>n2</dt>
<dd><p>the numbers of pools with corresponding pool sizes m1 in population 2</p></dd>


</dl></div>
    <div id="references">
    <h2>References</h2>
    

<p><em>Walter SD, Hildreth SW, Beaty BJ:</em> Estimation of infection rates in population of organisms using pools of variable size. <em>Am J Epidemiol 1980, 112(1):124-128</em></p>
<p><em>Hepworth G: Estimation of proportions by group testing. PhD Dissertation. 
   Melbourne, Australia: The University of Melbourne; 1999.</em></p>
<p><em>Biggerstaff BJ (2008)</em>: Confidence interval for the difference of proportions estmimated from pooled samples. <em>Journal of Agricultural Biological and Environmental Statistics 2008, 13(4):478-496.</em></p>
<p><em>Hepworth G, Biggerstaff BJ:</em> Bias correction in estimating Proportions by pooled testing. <em>JABES 2017, to appear.</em></p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Brad Biggerstaff</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Consider an imaginary example, where pools of size</span></span></span>
<span class="r-in"><span><span class="co"># 1, 5, 10 and 50 are tested, 5 pools of each size. The same </span></span></span>
<span class="r-in"><span><span class="co"># design is applied to estimate the prevalence in</span></span></span>
<span class="r-in"><span><span class="co"># two populations: </span></span></span>
<span class="r-in"><span><span class="co"># In population 1, among the 5 pools with size 1 and 5,</span></span></span>
<span class="r-in"><span><span class="co"># no positive pool is observed,</span></span></span>
<span class="r-in"><span><span class="co"># while among the 5 pools of size 10 and 50, 1 and 2 positive</span></span></span>
<span class="r-in"><span><span class="co"># pools are identified, respectively.</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># In population 2, 1 positive result is observed</span></span></span>
<span class="r-in"><span><span class="co"># among the 5 pools each pooling 5 elements,</span></span></span>
<span class="r-in"><span><span class="co"># no positive result among the pools pooling 10 elements,</span></span></span>
<span class="r-in"><span><span class="co"># 4 positive results among the pools pooling 50 elements,</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">pooledBinDiff</span><span class="op">(</span>x1<span class="op">=</span><span class="va">x1</span>, m1<span class="op">=</span><span class="va">m</span>, x2<span class="op">=</span><span class="va">x2</span>, m2<span class="op">=</span><span class="va">m</span>, n1<span class="op">=</span><span class="va">n</span>, n2<span class="op">=</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PointEst    Lower    Upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -0.0115  -0.0441   0.0115 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">pooledBinDiff</span><span class="op">(</span>x1<span class="op">=</span><span class="va">x1</span>, m1<span class="op">=</span><span class="va">m</span>, x2<span class="op">=</span><span class="va">x2</span>, m2<span class="op">=</span> <span class="va">m</span>, n1<span class="op">=</span><span class="va">n</span>, n2<span class="op">=</span><span class="va">n</span><span class="op">)</span>, scale<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation of Difference of Binomial Proportions for Pooled Data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  PointEst    Lower   Upper Scale</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -11.5018 -44.1487 11.5055  1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Point estimator: Firth's Correction </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI method: Skew-Corrected Score (Gart) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              PointEst  Lower   Upper Scale Individuals Pools Positive Pools</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Population 1  10.3249 2.8058 28.7939  1000         330    20              3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Population 2  21.8267 8.0707 53.4870  1000         330    20              5</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare recommended methods:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">pooledBinDiff</span><span class="op">(</span>x1<span class="op">=</span><span class="va">x1</span>, m1<span class="op">=</span><span class="va">m</span>, x2<span class="op">=</span><span class="va">x2</span>, m2<span class="op">=</span> <span class="va">m</span>, n1<span class="op">=</span><span class="va">n</span>, n2<span class="op">=</span><span class="va">n</span>, pt.method<span class="op">=</span><span class="st">"mle"</span>,</span></span>
<span class="r-in"><span> ci.method<span class="op">=</span><span class="st">"lrt"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PointEst    Lower    Upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -0.0127  -0.0438   0.0112 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">pooledBinDiff</span><span class="op">(</span>x1<span class="op">=</span><span class="va">x1</span>, m1<span class="op">=</span><span class="va">m</span>, x2<span class="op">=</span><span class="va">x2</span>, m2<span class="op">=</span> <span class="va">m</span>, n1<span class="op">=</span><span class="va">n</span>, n2<span class="op">=</span><span class="va">n</span>, pt.method<span class="op">=</span><span class="st">"mle"</span>,</span></span>
<span class="r-in"><span> ci.method<span class="op">=</span><span class="st">"score"</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PointEst    Lower    Upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -0.0127  -0.0418   0.0110 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">pooledBinDiff</span><span class="op">(</span>x1<span class="op">=</span><span class="va">x1</span>, m1<span class="op">=</span><span class="va">m</span>, x2<span class="op">=</span><span class="va">x2</span>, m2<span class="op">=</span> <span class="va">m</span>, n1<span class="op">=</span><span class="va">n</span>, n2<span class="op">=</span><span class="va">n</span>, pt.method<span class="op">=</span><span class="st">"mle"</span>,</span></span>
<span class="r-in"><span> ci.method<span class="op">=</span><span class="st">"skew-score"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PointEst    Lower    Upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -0.0127  -0.0441   0.0115 </span>
<span class="r-in"><span>  </span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Boan Zhang, Christopher Bilder, Brad Biggerstaff, Frank Schaarschmidt, Brianna Hitt.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

