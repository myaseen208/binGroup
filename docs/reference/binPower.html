<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Power Calculation for One Parameter Binomial Problem — binPower • binGroup</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Power Calculation for One Parameter Binomial Problem — binPower"><meta property="og:description" content="Closed calculation of the power to reject a hypothesis using confidence intervals for a single 
binomial proportion, for specified sample size n, conf.level and an assumed absolute difference to the
threshold parameter under the null hypothesis."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">binGroup</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Power Calculation for One Parameter Binomial Problem</h1>
    
    <div class="hidden name"><code>binPower.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Closed calculation of the power to reject a hypothesis using confidence intervals for a single 
binomial proportion, for specified sample size n, conf.level and an assumed absolute difference to the
threshold parameter under the null hypothesis.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">binPower</span><span class="op">(</span><span class="va">n</span>, <span class="va">delta</span>, <span class="va">p.hyp</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, </span>
<span>alternative <span class="op">=</span> <span class="st">"two.sided"</span>, method <span class="op">=</span> <span class="st">"CP"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>n</dt>
<dd><p>number of trials n in the binomial experiment, specify as a single integer</p></dd>

  <dt>delta</dt>
<dd><p>assumed absolute difference of the true proportion to the threshold proportion under the null hypothesis</p></dd>

  <dt>p.hyp</dt>
<dd><p>threshold proportion under the null hypothesis</p></dd>

  <dt>conf.level</dt>
<dd><p>nominal confidence level of the interval</p></dd>

   <dt>alternative</dt>
<dd><p>character string, defining the alternative hypothesis, either <kbd>'two.sided'</kbd>, <kbd>'less'</kbd> or <kbd>'greater'</kbd>
where <kbd>'less'</kbd> calculates the 'power of the upper confidence limit' for a true proportion <kbd>p.hyp</kbd> - <kbd>delta</kbd>,
<kbd>'greater'</kbd> calculates the 'power of the lower confidece limit' for a true proportion of <kbd>p.hyp</kbd> + <kbd>delta</kbd>.
<kbd>'two.sided'</kbd> calculates min(power(<kbd>p.hyp</kbd> - <kbd>delta</kbd>, <kbd>p.hyp</kbd> + <kbd>delta</kbd>)) for a two-sided CI, thus can result in much lower power.</p></dd>


  <dt>method</dt>
<dd><p>Character string, specifying the confidence interval method (see <code><a href="binCI.html">binCI</a></code>) to be used</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The power of a confidence interval here is defined as the probability that a confidence interval or limit excludes the threshold parameter (<kbd>p.hyp</kbd>) of the null hypothesis. 
E.g., the null hypothesis H0: p&gt;= 0.005 can be rejected, if an upper confidence limit for p does not contain p.hyp=0.005.
In case that a delta of 0.002 shall be detectable, this function calculates the probability, that an interval of a given method will
exclude p.hyp=0.005 if the true proportion = 0.003.
Due to discreteness, the power does not increase monotone for increasing sample size (number of trials or indivoiduals under observation) n,
but exhibits local maxima and minima, depending on n, conf.level and p.hyp.
The power can be identical for different methods, depending on the particular combination of n, p.hyp, conf.level.
Note, that coverage probability and power are not necessarily symmetric for upper and lower bound of binomial CI, 
especially for Wald, Wilson Score and Agresti-Coull CI.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>A list containing</p>
<dl><dt>power</dt>
<dd><p>the power which is achieved for the specified parameters and method</p></dd>

</dl></div>
    <div id="author">
    <h2>Author</h2>
    <p>Frank Schaarschmidt</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="binDesign.html">binDesign</a></code> for iteration of a sample size n for which a specified power is reached</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># What is the probability to reject the null hypothesis</span></span></span>
<span class="r-in"><span><span class="co"># H0: p &gt;= 0.02 in order to show that the alternative</span></span></span>
<span class="r-in"><span><span class="co"># hypothesis HA: p &lt; 0.02 is very likely in the first</span></span></span>
<span class="r-in"><span><span class="co"># example of if 200 seeds are taken from a seed lot and</span></span></span>
<span class="r-in"><span><span class="co"># are checked for the proportion of defectives.</span></span></span>
<span class="r-in"><span><span class="co"># Assume a true proportion under the alternative:</span></span></span>
<span class="r-in"><span><span class="co"># p = 0.01, i.e. a absolute difference delta = 0.01 </span></span></span>
<span class="r-in"><span><span class="co"># to the threshold proportion p.hyp=0.02.</span></span></span>
<span class="r-in"><span><span class="co"># The null hypothesis can be rejected if the threshold</span></span></span>
<span class="r-in"><span><span class="co"># p.hyp=0.02 is excluded by an 95 percent upper bound of the </span></span></span>
<span class="r-in"><span><span class="co"># Clopper-Pearson CI. What is the probability  of this event?</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">binPower</span><span class="op">(</span>n<span class="op">=</span><span class="fl">200</span>, delta<span class="op">=</span><span class="fl">0.01</span>, p.hyp<span class="op">=</span><span class="fl">0.02</span>,</span></span>
<span class="r-in"><span> alternative<span class="op">=</span><span class="st">"less"</span>, method<span class="op">=</span><span class="st">"CP"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1339797</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Assuming a lower true proportion (if one is satisfied</span></span></span>
<span class="r-in"><span><span class="co"># also with the situation that we can only reject H0</span></span></span>
<span class="r-in"><span><span class="co"># in case that the seed lot has a very high purity, e.g.</span></span></span>
<span class="r-in"><span><span class="co"># only a proportion of 0.001 defectives )</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">binPower</span><span class="op">(</span>n<span class="op">=</span><span class="fl">200</span>, delta<span class="op">=</span><span class="fl">0.019</span>, p.hyp<span class="op">=</span><span class="fl">0.02</span>,</span></span>
<span class="r-in"><span> alternative<span class="op">=</span><span class="st">"less"</span>, method<span class="op">=</span><span class="st">"CP"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8186488</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Or use a higher sample size:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">binPower</span><span class="op">(</span>n<span class="op">=</span><span class="fl">600</span>, delta<span class="op">=</span><span class="fl">0.01</span>, p.hyp<span class="op">=</span><span class="fl">0.02</span>,</span></span>
<span class="r-in"><span> alternative<span class="op">=</span><span class="st">"less"</span>, method<span class="op">=</span><span class="st">"CP"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6063041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Boan Zhang, Christopher Bilder, Brad Biggerstaff, Frank Schaarschmidt, Brianna Hitt.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

