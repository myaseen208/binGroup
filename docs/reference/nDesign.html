<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Iterate Sample Size in One Parameter Group Testing — nDesign • binGroup</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Iterate Sample Size in One Parameter Group Testing — nDesign"><meta property="og:description" content="Increasing number of groups (assays, bulk samples) for a fixed group size in a binomial group testing design,
until a pre-specified power is achieved. At the same time, bias of the estimator is controlled. A hypothetical
threshold proportion p.hyp and the absolute difference delta to be detected have to be specified."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">binGroup</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Iterate Sample Size in One Parameter Group Testing</h1>
    
    <div class="hidden name"><code>nDesign.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Increasing number of groups (assays, bulk samples) for a fixed group size in a binomial group testing design,
until a pre-specified power is achieved. At the same time, bias of the estimator is controlled. A hypothetical
threshold proportion p.hyp and the absolute difference delta to be detected have to be specified.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">nDesign</span><span class="op">(</span><span class="va">nmax</span>, <span class="va">s</span>, <span class="va">delta</span>, <span class="va">p.hyp</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, </span>
<span>power <span class="op">=</span> <span class="fl">0.8</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span>, method <span class="op">=</span> <span class="st">"CP"</span>, biasrest <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>nmax</dt>
<dd><p>either a single integer giving the maximal number of individuals n allowed in the iteration,
 or a vector of two integers giving the range of n in which power shall be iterated</p></dd>

  <dt>s</dt>
<dd><p>integer, fixed group size (number of units per group)</p></dd>

  <dt>delta</dt>
<dd><p>absolute difference between the threshold and the true proportion which shall be detectable with specified power</p></dd>

  <dt>p.hyp</dt>
<dd><p>threshold proportion to test against in the hypothesis, specify as a value between 0 and 1</p></dd>

  <dt>conf.level</dt>
<dd><p>confidence level of the decision, default is 0.95</p></dd>

  <dt>power</dt>
<dd><p>level of power to be achieved to be specified as a probability between 0 and 1</p></dd>

  <dt>alternative</dt>
<dd><p>character string, defining the alternative hypothesis, either <kbd>'two.sided'</kbd>, <kbd>'less'</kbd> or <kbd>'greater'</kbd>
	where <kbd>'less'</kbd> calculates the probability that p.hyp is excluded by an upper confidence limit for a true proportion <kbd>p.hyp</kbd> - <kbd>delta</kbd>,
	<kbd>'greater'</kbd> calculates the probability that p.hyp is excluded by a lower confidence limit for a true proportion <kbd>p.hyp</kbd> + <kbd>delta</kbd>.
	<kbd>'two.sided'</kbd> calculates min(power(<kbd>p.hyp</kbd> - <kbd>delta</kbd>, <kbd>p.hyp</kbd> + <kbd>delta</kbd>)) for a two.sided CI, thus can result in much lower power.</p></dd>


  <dt>method</dt>
<dd><p>character string specifying the CImethod to be used for evaluation, see argument method in bgtCI</p></dd>

  <dt>biasrest</dt>
<dd><p>value between 0 and 1 specifying the absolute bias maximally allowed</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The power of a confidence interval here is defined as the probability that a confidence interval or limit excludes the threshold parameter (p.hyp) of the hypothesis.</p>
<p>This function increases the number of groups (i.e. number of observations or assays in binomial group testing) until a pre-specified power is reached 
or the maximal number of groups <kbd>nmax</kbd> (specified in the function call) is reached. 
Since the power does not increase monotone with increasing n for binomial proportions but oscillates between local maxima and minima, 
the simple iteration given here will generally result in selecting those n, for which the given CI method shows a local minimum of 
coverage if the null hypothesis is true.
Bias decreases monotone with increasing the number of groups (if other parameters are fixed)
The resulting Problems of chosing a number of groups which results in satisfactory power, are solved in the following manner:</p>
<p>In case that the pre-specified power can be reached within the given range of n, the smallest n will be returned for which at least this power is reached, as
well as the actual power for this n.</p>
<p>In case that the pre-specified power is not reached within the given value, that n is returned for which maximal power is achieved, and the corresponding value of power.</p>
<p>In case that biasrestriction is violated even for the largest n within the given range of n, simply that n will be returned for which power was largest in the given range.
Due to discreteness of binomial distribution, power can be zero for one-sided hypothesis over a range of n.</p>
<p>The power can be identical for different methods, depending on the particular combination of n, s, p.hyp, conf.level.</p>
<p>Especially for large n, the calculation time may become large (particularly for Blaker). Then only the range of sample size which is of interest
can be specified in nmax, f.e. as: nmax=c(150,300). Alternatively, the function bgtPower might be used instead
to calculate power and bias only for some particular combinations of n, s, delta, p.hyp,... .</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list containing</p>
<dl><dt>nout </dt>
<dd><p>the number of groups (assays or bulk samples) necessary reach the power with the specified parameters</p></dd>

  <dt>powerout </dt>
<dd><p>the power for the specified parameters and selected number of groups n</p></dd>

  <dt>biasout </dt>
<dd><p>the bias for the specified parameters and the selected number of groups n</p></dd>

</dl><p>and a number of values specified in the function call or produced in the iteration, which are only necessary to apply
the function plot() on objects of class 'nDesign'</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p><em>Schaarschmidt F (2007).</em> Experimental design for one-sided confidence intervals or hypothesis tests in binomial group testing. Communications in Biometry and Crop Science 2 (1), 32-40.
 http://agrobiol.sggw.waw.pl/cbcs/</p>
<p><em>Swallow WH (1985).</em> Group testing for estimating infection rates and probabilities of disease transmission. Phytopathology Vol.75, N.8, 882-889.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Frank Schaarschmidt</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="plot.bgtDesign.html">plot.nDesign</a></code> to plot the iteration of this function</p>
<p><code><a href="bgtPower.html">bgtPower</a></code>: calculation of power and bias depending on n, s, delta, p.hyp, conf.level, method
<code><a href="sDesign.html">sDesign</a></code>:  function for stepwise increasing group size s for a given n in order to achieve sufficient power within a biasrestriction
<code><a href="estDesign.html">estDesign</a></code>:  function to choose group size s according to the minimal mse of the estimator, as given in Swallow (1985)</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Assume one aims to show that a proportion is smaller</span></span></span>
<span class="r-in"><span><span class="co">## 0.005 (i.e. 0.5 per cent) with a power </span></span></span>
<span class="r-in"><span><span class="co">## of 0.80 (i.e. 80 per cent) if the unknown proportion</span></span></span>
<span class="r-in"><span><span class="co">## in the population is 0.003 (i.e. 0.3 per cent),</span></span></span>
<span class="r-in"><span><span class="co">## thus, to detect a delta of 0.002.</span></span></span>
<span class="r-in"><span><span class="co">## The Clopper Pearson CI shall be used. </span></span></span>
<span class="r-in"><span><span class="co">## The maximal group size because of limited</span></span></span>
<span class="r-in"><span><span class="co">## sensitivity of assay might be s=20 and we</span></span></span>
<span class="r-in"><span><span class="co">## can only afford to perform maximally 100 assays:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">nDesign</span><span class="op">(</span>nmax<span class="op">=</span><span class="fl">100</span>, s<span class="op">=</span><span class="fl">20</span>, delta<span class="op">=</span><span class="fl">0.002</span>, p.hyp<span class="op">=</span><span class="fl">0.005</span>,</span></span>
<span class="r-in"><span> alternative<span class="op">=</span><span class="st">"less"</span>, method<span class="op">=</span><span class="st">"CP"</span>, power<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Power was not reached in the range of n = 4 , 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximal power was reached for n = 94 with power = 0.3533 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> and bias = 1.572e-05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true proportion is less than 0.005 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assumed true proportion = 0.003 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## A power of 80 per cent can not be reached but</span></span></span>
<span class="r-in"><span><span class="co">## only 30 percent with n=100 </span></span></span>
<span class="r-in"><span><span class="co">## One might accept to show significance only for a </span></span></span>
<span class="r-in"><span><span class="co">## lower true proportion = 0.001 i.e accepting to be</span></span></span>
<span class="r-in"><span><span class="co">## able to show significance only if true proportion </span></span></span>
<span class="r-in"><span><span class="co">## is delta=0.004 smaller than the threshold</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">nDesign</span><span class="op">(</span>nmax<span class="op">=</span><span class="fl">100</span>, s<span class="op">=</span><span class="fl">20</span>, delta<span class="op">=</span><span class="fl">0.004</span>, p.hyp<span class="op">=</span><span class="fl">0.005</span>,</span></span>
<span class="r-in"><span> alternative<span class="op">=</span><span class="st">"less"</span>, method<span class="op">=</span><span class="st">"CP"</span>, power<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Power was reached without violating bias restriction</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> for n = 64 with power = 0.8661 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> and bias = 7.572e-06 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true proportion is less than 0.005 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assumed true proportion = 0.001 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test</span><span class="op">&lt;-</span><span class="fu">nDesign</span><span class="op">(</span>nmax<span class="op">=</span><span class="fl">100</span>, s<span class="op">=</span><span class="fl">30</span>, delta<span class="op">=</span><span class="fl">0.004</span>, p.hyp<span class="op">=</span><span class="fl">0.005</span>,</span></span>
<span class="r-in"><span> alternative<span class="op">=</span><span class="st">"less"</span>, method<span class="op">=</span><span class="st">"CP"</span>, power<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="nDesign-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Boan Zhang, Christopher Bilder, Brad Biggerstaff, Frank Schaarschmidt, Brianna Hitt.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

