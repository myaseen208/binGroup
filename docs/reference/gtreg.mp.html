<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fitting Group Testing Models in Matrix Pooling Setting — gtreg.mp • binGroup</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting Group Testing Models in Matrix Pooling Setting — gtreg.mp"><meta property="og:description" content="gtreg.mp is a function to fit the group testing regression model in the matrix pooling setting specified through a symbolic description of the linear predictor and descriptions of the group testing setting."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">binGroup</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fitting Group Testing Models in Matrix Pooling Setting</h1>
    
    <div class="hidden name"><code>gtreg.mp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><kbd>gtreg.mp</kbd> is a function to fit the group testing regression model in the matrix pooling setting specified through a symbolic description of the linear predictor and descriptions of the group testing setting.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gtreg.mp</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">coln</span>, <span class="va">rown</span>, <span class="va">arrayn</span>, retest <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span> sens <span class="op">=</span> <span class="fl">1</span>, spec <span class="op">=</span> <span class="fl">1</span>,  linkf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logit"</span>, <span class="st">"probit"</span>, <span class="st">"cloglog"</span><span class="op">)</span>,</span>
<span> sens.ind <span class="op">=</span> <span class="cn">NULL</span>, spec.ind <span class="op">=</span> <span class="cn">NULL</span>,  start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span> control <span class="op">=</span> <span class="fu"><a href="gt.control.html">gt.control</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">EM.mp</span><span class="op">(</span><span class="va">col.resp</span>, <span class="va">row.resp</span>, <span class="va">X</span>, <span class="va">coln</span>, <span class="va">rown</span>, <span class="va">sqn</span>, <span class="va">ret</span>, <span class="va">sens</span>, <span class="va">spec</span>,</span>
<span> <span class="va">linkf</span>, <span class="va">sens.ind</span>, <span class="va">spec.ind</span>, start <span class="op">=</span> <span class="cn">NULL</span>, control <span class="op">=</span> <span class="fu"><a href="gt.control.html">gt.control</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>an object of class <kbd>"formula"</kbd> (or one that can be coerced to that class): a symbolic description of the model to be fitted. The details of model specification are given under 'Details'.</p></dd>

  <dt>data</dt>
<dd><p>an optional data frame, list or environment (or object coercible by <kbd>as.data.frame</kbd> to a data frame) containing the variables in the model. If not found in <kbd>data</kbd>, the variables are taken from <kbd>environment(formula)</kbd>, typically the environment from which <kbd>gtreg.mp</kbd> is called.</p></dd>

  <dt>coln</dt>
<dd><p>a vector, list or data frame that specifies column group number for each sample</p></dd>

  <dt>rown</dt>
<dd><p>a vector, list or data frame that specifies row group number for each sample</p></dd>

  <dt>arrayn</dt>
<dd><p>a vector, list or data frame that specifies array number for each sample</p></dd>

  <dt>retest</dt>
<dd><p>a vector, list or data frame of individual retest results. A 0 denotes negative and 1 denotes positive. A <code>NA</code> denotes that no retest is performed for that individual. Default value is <code>NULL</code> for no retests.</p></dd>

  <dt>sens</dt>
<dd><p>sensitivity of the group tests, set to be 1 by default.</p></dd>

  <dt>spec</dt>
<dd><p>specificity of the group tests, set to be 1 by default.</p></dd>

  <dt>sens.ind</dt>
<dd><p>sensitivity of the individual retests, set to be equal to <kbd>sens</kbd> if not specified otherwise.</p></dd>

  <dt>spec.ind</dt>
<dd><p>specificity of the individual retests, set to be equal to <kbd>spec</kbd> if not specified otherwise.</p></dd>


  <dt>linkf</dt>
<dd><p>a character string specifying one of the three link functions for a binomial model: <kbd>"logit"</kbd> (default) or <kbd>"probit"</kbd> or <kbd>"cloglog"</kbd>.</p></dd>


<dt>start</dt>
<dd><p>starting values for the parameters in the linear predictor.</p></dd>


<dt>control</dt>
<dd><p>a list of parameters for controlling the fitting process. See the documentation for <code><a href="gt.control.html">gt.control</a></code> for details.</p></dd>


  <dt>col.resp</dt>
<dd><p>For <kbd>EM.mp</kbd>: vector of group responses of column pools for all samples. 0 denotes negative and 1 denotes positive.</p></dd>

  <dt>row.resp</dt>
<dd><p>For <kbd>EM.mp</kbd>: vector of group responses of row pools for all samples. 0 denotes negative and 1 denotes positive.</p></dd>

  <dt>X</dt>
<dd><p>For <kbd>EM.mp</kbd>: the design matrix of the covariates.</p></dd>


<dt>sqn</dt>
<dd><p>For <kbd>EM.mp</kbd>: a vector that specifies array number</p></dd>


<dt>ret</dt>
<dd><p>For <kbd>EM.mp</kbd>: a vector containing individual retest results</p></dd>


<dt>...</dt>
<dd><p>arguments to be passed to <code><a href="gt.control.html">gt.control</a></code>: see argument <kbd>control</kbd></p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>With matrix pooling, individual samples are placed in a matrix-like grid where samples are pooled within each row and within each column. This leads to two kinds of group responses: row and column group responses. Thus, a typical predictor has the form <kbd>cbind(col.resp, row.resp)</kbd> <kbd>~ covariates</kbd> where <kbd>col.resp</kbd> is the (numeric) column group response vector and <kbd>row.resp</kbd> is the (numeric) row group response vector.
 The covariates term is a series of terms which specifies a linear predictor for individual responses. Note that it is actually the unobserved individual responses, not the observed group responses, which are modeled by the covariates. In <kbd>col.resp</kbd> and <kbd>row.resp</kbd>, a 0 denotes a negative response and 1 denotes a positive response, where the probability of an individual positive response is being modeled directly. A terms specification of the form <kbd>first + second</kbd> indicates all the terms in <kbd>first</kbd> together with all the terms in <kbd>second</kbd> with duplicates removed. The terms in the formula will be re-ordered so that main effects come first, followed by the interactions, all second-order, all third-order and so on; to avoid this pass a <kbd>terms</kbd> object as the formula.</p>
<p>A specification of the form <kbd>first:second</kbd> indicates the set of terms obtained by taking the interactions of all terms in <kbd>first</kbd> with all terms in <kbd>second</kbd>. The specification <kbd>first*second</kbd> indicates the cross of <kbd>first</kbd> and <kbd>second</kbd>. This is the same as <kbd>first + second + first:second</kbd>.</p>
<p><kbd>EM.mp</kbd> is the workhorse function. It applies Xie`s EM algorithm to the likelihood function written in terms of the unobserved individual responses. In each E step, the Gibbs sampling technique is used to estimate the conditional probabilities. Because of the large number of Gibbs samples needed to achieve convergence, the model fitting process could be quite slow, especially when multiple positive rows and columns are observed. In this case, we can either increase the Gibbs sample size to help achieve convergence or loosen the convergence criteria by increasing <kbd>tol</kbd> at the expense of perhaps poorer estimates. If follow-up retests are performed, the retest results going into the model will help achieve convergence faster with the same Gibbs sample size and convergence criteria. In each M step, we use <kbd>glm.fit</kbd> to update the parameter estimates</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    


<p><kbd>gtreg.mp</kbd> returns an object of class <kbd>"gt.mp"</kbd> which inherits from the class <kbd>"gt"</kbd>. See later in this section. 
The function <kbd>summary</kbd> (i.e., <kbd>summary.gt.mp</kbd>) can be used to obtain or print a summary of the results. 
The group testing function <kbd>predict</kbd> (i.e., <kbd>predict.gt</kbd>) can be used to make predictions on <kbd>"gt.mp"</kbd> objects. 
An object of class <kbd>"gt.mp"</kbd> is a list containing at least the following components:</p>
<dl><dt> coefficients </dt>
<dd><p>a named vector of coefficients.</p></dd>

 <dt> hessian </dt>
<dd><p>estimated Hessian matrix of the negative log likelihood function, serves as an estimate of the information matrix</p></dd>

 <dt> counts </dt>
<dd><p>the number of iterations performed in the EM algorithm.</p></dd>

 <dt> Gibbs.sample.size </dt>
<dd><p>the number of Gibbs samples generated in each E step.</p></dd>

 <dt> call </dt>
<dd><p>the matched call.</p></dd>

 <dt> formula </dt>
<dd><p>the formula supplied.</p></dd>

 <dt> terms </dt>
<dd><p>the terms object used.</p></dd>

 <dt> link </dt>
<dd><p>the link function used in the model.</p></dd>


</dl></div>
    <div id="references">
    <h2>References</h2>
    <p><em>Xie, M. (2001)</em>, Regression analysis of group testing samples, <em>Statistics in Medicine, 20, 1957-1969.</em></p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Boan Zhang</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="summary.gt.mp.html">summary.gt.mp</a></code> and <code><a href="predict.gt.html">predict.gt</a></code> for <kbd>gt.mp</kbd> methods.
<code><a href="gtreg.html">gtreg</a></code> for the group testing regression model in the simple pooling setting.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## --- Continuing the Example from  '?sim.mp':</span></span></span>
<span class="r-in"><span><span class="co"># 5*6 and 4*5 matrix</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">9128</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sa1a</span><span class="op">&lt;-</span><span class="fu"><a href="sim.mp.html">sim.mp</a></span><span class="op">(</span>par<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7</span>,<span class="fl">0.1</span><span class="op">)</span>, n.row<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span><span class="op">)</span>, n.col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> sens<span class="op">=</span><span class="fl">0.95</span>, spec<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sa1</span><span class="op">&lt;-</span><span class="va">sa1a</span><span class="op">$</span><span class="va">dframe</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">gtreg.mp</span><span class="op">(</span>formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">col.resp</span>, <span class="va">row.resp</span><span class="op">)</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">sa1</span>, </span></span>
<span class="r-in"><span>                 coln <span class="op">=</span> <span class="va">coln</span>, rown <span class="op">=</span> <span class="va">rown</span>, arrayn <span class="op">=</span> <span class="va">arrayn</span>, </span></span>
<span class="r-in"><span>                 sens <span class="op">=</span> <span class="fl">0.95</span>, spec <span class="op">=</span> <span class="fl">0.95</span>, tol <span class="op">=</span> <span class="fl">0.005</span>, n.gibbs <span class="op">=</span> <span class="fl">2000</span>, trace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit1</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Here is an example of how long this fitting process may take. For the </span></span></span>
<span class="r-in"><span><span class="co">## following simulated data, it takes a computer with 2.2GHZ processor and </span></span></span>
<span class="r-in"><span><span class="co">## 3GB RAM about 6 minutes to achieve convergence.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">9012</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sa2a</span><span class="op">&lt;-</span><span class="fu"><a href="sim.mp.html">sim.mp</a></span><span class="op">(</span>par<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7</span>,<span class="fl">0.1</span><span class="op">)</span>, n.row<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>, n.col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>             sens<span class="op">=</span><span class="fl">0.95</span>, spec<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sa2</span><span class="op">&lt;-</span><span class="va">sa2a</span><span class="op">$</span><span class="va">dframe</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">gtreg.mp</span><span class="op">(</span>formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">col.resp</span>, <span class="va">row.resp</span><span class="op">)</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">sa2</span>, </span></span>
<span class="r-in"><span>                 coln <span class="op">=</span> <span class="va">coln</span>, rown <span class="op">=</span> <span class="va">rown</span>, arrayn <span class="op">=</span> <span class="va">arrayn</span>, retest <span class="op">=</span> <span class="va">retest</span>,</span></span>
<span class="r-in"><span>                 sens <span class="op">=</span> <span class="fl">0.95</span>, spec <span class="op">=</span> <span class="fl">0.95</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7</span>, <span class="fl">0.1</span><span class="op">)</span>, tol <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit2</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Boan Zhang, Christopher Bilder, Brad Biggerstaff, Frank Schaarschmidt, Brianna Hitt.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

