<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Operating characteristics for hierarchical group testing — hierarchical.desc2 • binGroup</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Operating characteristics for hierarchical group testing — hierarchical.desc2"><meta property="og:description" content="Calculate operating characteristics for hierarchical 
group testing with up to four stages, given a vector of individual 
probabilities and a testing configuration."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">binGroup</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Operating characteristics for hierarchical group testing</h1>
    
    <div class="hidden name"><code>hierarchical.desc2.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate operating characteristics for hierarchical 
group testing with up to four stages, given a vector of individual 
probabilities and a testing configuration.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hierarchical.desc2</span><span class="op">(</span><span class="va">p</span>, I2 <span class="op">=</span> <span class="cn">NULL</span>, I3 <span class="op">=</span> <span class="cn">NULL</span>, se <span class="op">=</span> <span class="fl">1</span>, sp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  order.p <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>p</dt>
<dd><p>vector of probabilities corresponding to each individual's 
risk of disease.</p></dd>


<dt>I2</dt>
<dd><p>a numeric vector of pool sizes for stage 2 testing (used in 
hierarchical testing with at least three stages).</p></dd>


<dt>I3</dt>
<dd><p>a numeric vector of pool sizes for stage 3 testing (used in 
hierarchical testing with at least four stages).</p></dd>


<dt>se</dt>
<dd><p>the sensitivity of the diagnostic test.</p></dd>


<dt>sp</dt>
<dd><p>the specificity of the diagnostic test.</p></dd>


<dt>order.p</dt>
<dd><p>a logical value indicating whether the vector of 
individual probabilities needs to be sorted.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list containing:</p>
<dl><dt>ET</dt>
<dd><p>the expected number of tests.</p></dd>

<dt>stages</dt>
<dd><p>the number of stages in the testing algorithm.</p></dd>

<dt>group.size</dt>
<dd><p>the total number of individuals tested in the 
algorithm.</p></dd>

<dt>I2</dt>
<dd><p>pool sizes for the second stage of testing, or
"individual testing" if there are only two stages of testing.</p></dd>

<dt>I3</dt>
<dd><p>pool sizes for the third stage of testing, or
"individual testing" if there are only three stages of testing.</p></dd>

<dt>m1</dt>
<dd><p>the initial (stage 1) group size for two stage testing, 
or the number of subgroups originating from the initial group.</p></dd>

<dt>m2</dt>
<dd><p>the number of subgroups for each preceding group 
containing more than one individual, or "individual testing" 
if there are only two stages of testing.</p></dd>

<dt>m3</dt>
<dd><p>the number of subgroups for each preceding group 
containing more than one individual, or "individual testing" 
if there are only three stages of testing. NULL if there are 
only two stages of testing.</p></dd>

<dt>individual.testerror</dt>
<dd><p>a data frame containing:</p><dl><dt>pse.vec</dt>
<dd><p>a vector containing each individual's pooling 
sensitivity.</p></dd>

<dt>psp.vec</dt>
<dd><p>a vector containing each individual's pooling 
specificity.</p></dd>

<dt>pppv.vec</dt>
<dd><p>a vector containing each individual's pooling 
positive predictive value.</p></dd>

<dt>pnpv.vec</dt>
<dd><p>a vector containing each individual's pooling
negative predictive value.</p></dd>

</dl></dd>

<dt>group.testerror</dt>
<dd><p>a vector containing:</p><dl><dt>PSe</dt>
<dd><p>the overall pooling sensitivity for the algorithm. 
Further details are given under 'Details'.</p></dd>

<dt>PSp</dt>
<dd><p>the overall pooling specificity for the algorithm. 
Further details are given under 'Details'.</p></dd>

<dt>PPPV</dt>
<dd><p>the overall pooling positive predictive value 
for the algorithm. Further details are given under 'Details'.</p></dd>

<dt>PNPV</dt>
<dd><p>the overall pooling negative predictive value
for the algorithm. Further details are given under 'Details'.</p></dd>

</dl></dd>

<dt>individual.probabilities</dt>
<dd><p>a vector containing each 
individual's probability of disease. If <kbd>order.p=TRUE</kbd>, this
is the sorted vector of individual probabilities.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function calculates the operating characteristics for
hierarchical group testing with up to four stages of testing. 
Operating characteristics calculated are expected number of tests, 
and pooling sensitivity, pooling specificity, pooling positive 
predictive value, and pooling negative predictive value, for each 
individual and for the configuration overall.</p>
<p>If <kbd>I2</kbd> is NULL, there are two stages of testing. If <kbd>I3</kbd> 
is NULL but <kbd>I2</kbd> has values, there are three stages of testing.
If both <kbd>I2</kbd> and <kbd>I3</kbd> have values, there are four stages 
of testing.</p>
<p>Vectors <kbd>I2</kbd> and <kbd>I3</kbd> should be entered using notation
that keeps track of all individuals through all stages (e.g. for
a group of 10 individuals that splits into 5, 4, and 1 individual
at stage 2, then into 3, 2, 2, 1, and 1 individual at stage 3
before individual testing at stage 4, then I2=c(5,4,1) and 
I3=c(3,2,2,1,1,1) so that the specimen that was tested 
individually at stage 2 is still numbered at stage 3 even though
it will not be tested again).</p>
<p>The displayed pooling sensitivity, pooling specificity, pooling positive 
predictive value, and pooling negative predictive value are weighted 
averages of the corresponding individual accuracy measures for all 
individuals within the initial group for a hierarchical algorithm.
Expressions for these averages are provided in the Supplementary 
Material for Hitt et al. (2018). These expressions are based on accuracy 
definitions given by Altman and Bland (1994a, 1994b).</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>This function returns the pooling positive and negative
predictive values for all individuals even though these measures are 
diagnostic specific; i.e., PPPV (PNPV) should only be considered
for those individuals who have tested positive (negative).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Black, M., Bilder, C., Tebbs, J. (2015).
“Optimal retesting configurations for hierarchical group testing.”
<em>Journal of the Royal Statistical Society. Series C: Applied Statistics</em>, <b>64</b>(4), 693--710.
ISSN 14679876, <a href="https://doi.org/10.1111/rssc.12097" class="external-link">doi:10.1111/rssc.12097</a>
.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="Array.Measures.html">Array.Measures</a></code> for calculating operating characteristics
under array testing without master pooling, 
<code><a href="MasterPool.Array.Measures.html">MasterPool.Array.Measures</a></code> for non-informative array 
testing with master pooling, and <code><a href="inf.dorf.measures.html">inf.dorf.measures</a></code> 
for informative two-stage hierarchical testing. See 
<code><a href="p.vec.func.html">p.vec.func</a></code> for generating a vector of 
individual risk probabilities for informative group testing.</p>
<p><a href="http://chrisbilder.com/grouptesting" class="external-link">http://chrisbilder.com/grouptesting</a></p>
<p>Other Operating characteristic functions: <code><a href="Array.Measures.html">Array.Measures</a></code>,
  <code><a href="MasterPool.Array.Measures.html">MasterPool.Array.Measures</a></code>,
  <code><a href="inf.dorf.measures.html">inf.dorf.measures</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>This function was originally written by Michael S. 
Black for Black et al. (2015). The function was obtained from 
<a href="http://chrisbilder.com/grouptesting" class="external-link">http://chrisbilder.com/grouptesting</a>. Minor modifications were made 
to the function for inclusion in the binGroup package.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Calculate the operating characteristics for </span></span></span>
<span class="r-in"><span><span class="co">#   non-informative two-stage hierarchical testing</span></span></span>
<span class="r-in"><span><span class="co">#   with an overall disease prevalence of p = 0.015</span></span></span>
<span class="r-in"><span><span class="co">#   and an initial group size of 12.</span></span></span>
<span class="r-in"><span><span class="co"># This example takes less than 1 second to run.</span></span></span>
<span class="r-in"><span><span class="co"># Estimated running time was calculated using a </span></span></span>
<span class="r-in"><span><span class="co">#   computer with 16 GB of RAM and one core of an </span></span></span>
<span class="r-in"><span><span class="co">#   Intel i7-6500U processor.</span></span></span>
<span class="r-in"><span><span class="va">p.vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">0.015</span>, times<span class="op">=</span><span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">hierarchical.desc2</span><span class="op">(</span>p<span class="op">=</span><span class="va">p.vec</span>, I2<span class="op">=</span><span class="cn">NULL</span>, I3<span class="op">=</span><span class="cn">NULL</span>, se<span class="op">=</span><span class="fl">0.95</span>, </span></span>
<span class="r-in"><span>sp<span class="op">=</span><span class="fl">0.95</span>, order.p<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ET</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3.391375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $stages</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $group.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $I2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "individual testing"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $I3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $m1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $m2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "individual testing"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $m3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $individual.testerror</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        p pse.vec   psp.vec pppv.vec  pnpv.vec</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.015  0.9025 0.9906076 0.594035 0.9985034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.015  0.9025 0.9906076 0.594035 0.9985034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.015  0.9025 0.9906076 0.594035 0.9985034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.015  0.9025 0.9906076 0.594035 0.9985034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.015  0.9025 0.9906076 0.594035 0.9985034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  0.015  0.9025 0.9906076 0.594035 0.9985034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  0.015  0.9025 0.9906076 0.594035 0.9985034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  0.015  0.9025 0.9906076 0.594035 0.9985034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  0.015  0.9025 0.9906076 0.594035 0.9985034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 0.015  0.9025 0.9906076 0.594035 0.9985034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 0.015  0.9025 0.9906076 0.594035 0.9985034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 0.015  0.9025 0.9906076 0.594035 0.9985034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $group.testerror</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       PSe       PSp      PPPV      PNPV </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.9025000 0.9906076 0.5940350 0.9985034 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $individual.probabilities</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.015 0.015 0.015 0.015 0.015 0.015 0.015 0.015 0.015 0.015 0.015 0.015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate the operating characteristics for </span></span></span>
<span class="r-in"><span><span class="co">#   non-informative three-stage hierarchical testing</span></span></span>
<span class="r-in"><span><span class="co">#   with an overall disease prevalence of p = 0.04, </span></span></span>
<span class="r-in"><span><span class="co">#   where an initial group of 20 individuals is </span></span></span>
<span class="r-in"><span><span class="co">#   split into equally sized subgroups of 5 each.</span></span></span>
<span class="r-in"><span><span class="co"># This example takes less than 1 second to run.</span></span></span>
<span class="r-in"><span><span class="co"># Estimated running time was calculated using a </span></span></span>
<span class="r-in"><span><span class="co">#   computer with 16 GB of RAM and one core of an </span></span></span>
<span class="r-in"><span><span class="co">#   Intel i7-6500U processor.</span></span></span>
<span class="r-in"><span><span class="va">p.vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">0.04</span>, times<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">hierarchical.desc2</span><span class="op">(</span>p<span class="op">=</span><span class="va">p.vec</span>, I2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">5</span>, times<span class="op">=</span><span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>I3<span class="op">=</span><span class="cn">NULL</span>, se<span class="op">=</span><span class="fl">0.99</span>, sp<span class="op">=</span><span class="fl">0.99</span>, order.p<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ET</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6.921226</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $stages</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $group.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $I2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5 5 5 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $I3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "individual testing"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $m1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $m2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5 5 5 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $m3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "individual testing"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $individual.testerror</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       p  pse.vec   psp.vec  pppv.vec  pnpv.vec</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.04 0.970299 0.9984845 0.9638686 0.9987621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.04 0.970299 0.9984845 0.9638686 0.9987621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.04 0.970299 0.9984845 0.9638686 0.9987621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.04 0.970299 0.9984845 0.9638686 0.9987621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.04 0.970299 0.9984845 0.9638686 0.9987621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  0.04 0.970299 0.9984845 0.9638686 0.9987621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  0.04 0.970299 0.9984845 0.9638686 0.9987621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  0.04 0.970299 0.9984845 0.9638686 0.9987621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  0.04 0.970299 0.9984845 0.9638686 0.9987621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 0.04 0.970299 0.9984845 0.9638686 0.9987621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 0.04 0.970299 0.9984845 0.9638686 0.9987621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 0.04 0.970299 0.9984845 0.9638686 0.9987621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 0.04 0.970299 0.9984845 0.9638686 0.9987621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 0.04 0.970299 0.9984845 0.9638686 0.9987621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 0.04 0.970299 0.9984845 0.9638686 0.9987621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 0.04 0.970299 0.9984845 0.9638686 0.9987621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 0.04 0.970299 0.9984845 0.9638686 0.9987621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 0.04 0.970299 0.9984845 0.9638686 0.9987621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 0.04 0.970299 0.9984845 0.9638686 0.9987621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 0.04 0.970299 0.9984845 0.9638686 0.9987621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $group.testerror</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       PSe       PSp      PPPV      PNPV </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.9702990 0.9984845 0.9638686 0.9987621 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $individual.probabilities</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04 0.04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] 0.04 0.04 0.04 0.04 0.04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate the operating characteristics for </span></span></span>
<span class="r-in"><span><span class="co">#   informative three-stage hierarchical testing</span></span></span>
<span class="r-in"><span><span class="co">#   where an initial group of 10 individuals is </span></span></span>
<span class="r-in"><span><span class="co">#   split into subsequent groups of 5, 4, and 1 </span></span></span>
<span class="r-in"><span><span class="co">#   individual.</span></span></span>
<span class="r-in"><span><span class="co"># A vector of individual probabilities is generated using</span></span></span>
<span class="r-in"><span><span class="co">#   the expected value of order statistics from a beta </span></span></span>
<span class="r-in"><span><span class="co">#   distribution with p = 0.02 and a heterogeneity level </span></span></span>
<span class="r-in"><span><span class="co">#   of alpha = 0.5. Depending on the specified probability, </span></span></span>
<span class="r-in"><span><span class="co">#   alpha level, and overall group size, simulation may </span></span></span>
<span class="r-in"><span><span class="co">#   be necessary in order to generate the vector of individual</span></span></span>
<span class="r-in"><span><span class="co">#   probabilities. This is done using p.vec.func() and </span></span></span>
<span class="r-in"><span><span class="co">#   requires the user to set a seed in order to reproduce </span></span></span>
<span class="r-in"><span><span class="co">#   results.</span></span></span>
<span class="r-in"><span><span class="co"># This example takes less than 1 second to run.</span></span></span>
<span class="r-in"><span><span class="co"># Estimated running time was calculated using a </span></span></span>
<span class="r-in"><span><span class="co">#   computer with 16 GB of RAM and one core of an </span></span></span>
<span class="r-in"><span><span class="co">#   Intel i7-6500U processor.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1002</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p.vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="p.vec.func.html">p.vec.func</a></span><span class="op">(</span>p<span class="op">=</span><span class="fl">0.02</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, grp.sz<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">hierarchical.desc2</span><span class="op">(</span>p<span class="op">=</span><span class="va">p.vec</span>, I2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span>, I3<span class="op">=</span><span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>se<span class="op">=</span><span class="fl">0.90</span>, sp<span class="op">=</span><span class="fl">0.90</span>, order.p<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ET</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.331819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $stages</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $group.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $I2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5 4 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $I3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "individual testing"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $m1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $m2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5 4 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $m3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "individual testing"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $individual.testerror</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               p pse.vec   psp.vec   pppv.vec  pnpv.vec</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.0005375008   0.729 0.9961325 0.09203947 0.9998537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.0016086773   0.729 0.9962152 0.23684704 0.9995619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.0032157554   0.729 0.9963397 0.39118422 0.9991233</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.0056367451   0.729 0.9965280 0.54342874 0.9984608</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.0089735358   0.729 0.9967891 0.67274984 0.9975443</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  0.0134782896   0.729 0.9911694 0.53005151 0.9962784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  0.0197205823   0.729 0.9916290 0.63662080 0.9945322</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  0.0288535042   0.729 0.9923120 0.73803337 0.9919513</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  0.0435118120   0.729 0.9934356 0.83476334 0.9877425</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 0.0744820220   0.810 0.9804384 0.76917728 0.9846440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $group.testerror</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       PSe       PSp      PPPV      PNPV </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7591624 0.9931945 0.6948204 0.9950752 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $individual.probabilities</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.0005375008 0.0016086773 0.0032157554 0.0056367451 0.0089735358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] 0.0134782896 0.0197205823 0.0288535042 0.0435118120 0.0744820220</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Boan Zhang, Christopher Bilder, Brad Biggerstaff, Frank Schaarschmidt, Brianna Hitt.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

